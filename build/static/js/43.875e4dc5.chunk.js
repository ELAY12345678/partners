(this["webpackJsonppartners-apparta"]=this["webpackJsonppartners-apparta"]||[]).push([[43],{1120:function(e,t,a){"use strict";a.r(t);a(362);var i=a(363),n=(a(377),a(379)),r=a(0),l=a(62),s=a(364),d=a(664),o=(a(366),a(367)),c=(a(368),a(369)),u=(a(357),a(358)),m=(a(219),a(361)),b=a(12),p=a(2),j=(a(218),a(69)),h=(a(386),a(387)),v=(a(351),a(352)),x=(a(143),a(142)),_=(a(372),a(373)),O=(a(408),a(412)),g=a(42),f=a.n(g),y=a(356),k=a(54),w=a(353),S=a(359),F=a(370),C=a(68),q=a(414),I=a(398),z=a(360),E=(a(394),a(393)),A=(a(375),a(376)),T=(a(354),a(355));var V=a(14);var B=e=>{let{modalVisible:t,onCancel:a,selectedBannerProgramming:i}=e;const n=Object(C.b)("establishments"),l=Object(C.b)("menu-banner-establishments"),[s,d]=Object(r.useState)([]),[o,c]=Object(r.useState)(),[m,b]=Object(r.useState)(1),[p,h,x]=(e=>{let{menu_banner_id:t,page:a}=e;const i=Object(C.b)("menu-banner-establishments"),[n,l]=Object(r.useState)({}),[s,d]=Object(r.useState)(!1),o=()=>{d(!0),i.find({query:{menu_banner_id:t,$limit:9,$skip:9*(a-1),$sort:{establishment_id:1}}}).then(e=>{let{data:t,total:a}=e;l({data:t,total:a}),d(!1)}).catch(()=>{l([]),d(!1)})};return Object(r.useEffect)(()=>{t&&o()},[t,a]),[n,o,s]})({menu_banner_id:null===i||void 0===i?void 0:i.id,page:m}),_=Object(g.debounce)(e=>{""!==e?n.find({query:{q:e,$select:["id","name"],$client:{skipJoins:!0},$limit:15}}).then(e=>{let{data:t}=e;d(f.a.sortBy(t,[e=>{let{name:t}=e;return t}]))}).catch(e=>j.b.error(e)):d([])},500,{maxWait:800});return Object(V.jsxs)(y.c,{title:"Establecimientos - ".concat(null===i||void 0===i?void 0:i.name),onCancel:a,visible:t,children:[Object(V.jsxs)(v.a,{gutter:8,children:[Object(V.jsx)(T.a,{flex:"auto",children:Object(V.jsx)(u.a,{showSearch:!0,placeholder:"A\xf1adir Establecimiento",allowClear:!0,onSearch:_,value:o,onClear:()=>c(),onSelect:e=>{c(e)},style:{width:"100%"},optionFilterProp:"children",filterOption:(e,t)=>t.children.toLowerCase().includes(e.toLowerCase()),children:f.a.map(s,(e,t)=>{let{id:a,name:i}=e;return Object(V.jsx)(u.a.Option,{value:a,children:i},t)})})}),Object(V.jsx)(T.a,{flex:"none",children:Object(V.jsx)(S.a,{type:"primary",onClick:()=>(e=>{let{establishment_id:t,menu_banner_id:a}=e;l.create({menu_banner_id:a,establishment_id:t,status:"active"}).then(()=>{j.b.success("Establecimiento a\xf1adido correctamente!"),c(),h()}).catch(e=>{j.b.error(null===e||void 0===e?void 0:e.message)})})({establishment_id:o,menu_banner_id:i.id}),children:"A\xf1adir"})})]}),Object(V.jsx)(A.a,{style:{background:"transparent",borderTop:0,marginTop:0}}),Object(V.jsx)(E.a,{loading:x,dataSource:(null===p||void 0===p?void 0:p.data)||[],columns:[{title:"Id Establecimiento",dataIndex:"establishment_id",key:"establishment_id"},{title:"Acciones",dataIndex:"id",key:"id",width:100,render:e=>Object(V.jsx)(S.a,{type:"link",onClick:()=>(e=>{let{id:t}=e;l.remove(t).then(()=>{j.b.success("Establecimiento eliminado correctamente!"),c(),h()}).catch(e=>{j.b.error(null===e||void 0===e?void 0:e.message)})})({id:e}),icon:Object(V.jsx)(w.h,{}),confirmText:"Desea eliminar?"})}],pagination:{current:m,showSizeChanger:!1,pageSize:9,onChange:e=>{b(e)},total:(null===p||void 0===p?void 0:p.total)||0,showTotal:e=>"Total ".concat(e," record").concat(e>1?"s":"")}})]})};const D=["id"],P=[{id:"active",name:"Active"},{id:"inactive",name:"Inactive"}],N=[{id:"specific",name:"Especifico"},{id:"general",name:"General"}],$=[{id:"go_to_screen",name:"Ir a pantalla"},{id:"external_link",name:"Link externo"},{id:"open_modal",name:"Modal"}],M=[{id:"product",name:"Producto"},{id:"establishment_profile",name:"Perfil de restaurante"}],Y=[{id:"gift",name:"Gift"},{id:"button",name:"Bottom"},{id:"top",name:"Top"},{id:"modal",name:"Modal"}],H=e=>{let{onRemove:t,onEdit:a,onWatch:i}=e;return[{title:"Id",dataIndex:"id",sorter:!0},{title:"Foto",dataIndex:"path_image",render:e=>e&&Object(V.jsx)(O.a,{size:"large",alt:"Banner",src:"".concat(k.f,"/").concat(window.imageShark({url:e,width:90,height:35})),preview:{src:"".concat(k.j).concat(e)}})},{title:"Nombre",dataIndex:"name",sorter:!0},{title:"Tipo",dataIndex:"type",sorter:!0,render:e=>{var t;return(null===(t=f.a.find(N,t=>{let{id:a}=t;return a===e}))||void 0===t?void 0:t.name)||""}},{title:"Tipo de acci\xf3n",dataIndex:"action_type",sorter:!0,render:e=>{var t;return(null===(t=f.a.find($,t=>{let{id:a}=t;return a===e}))||void 0===t?void 0:t.name)||""}},{title:"Acci\xf3n pantalla",dataIndex:"action_screen",sorter:!0,render:e=>{var t;return(null===(t=f.a.find(M,t=>{let{id:a}=t;return a===e}))||void 0===t?void 0:t.name)||""}},{title:"Acci\xf3n pantalla Id",dataIndex:"action_screen_id",sorter:!0},{title:"Ubicaci\xf3n",dataIndex:"location_screen",sorter:!0,render:e=>{var t;return(null===(t=f.a.find(Y,t=>{let{id:a}=t;return a===e}))||void 0===t?void 0:t.name)||""}},{title:"Estado",dataIndex:"status",sorter:!0,render:e=>"active"===e?Object(V.jsx)(_.a,{color:"green",children:"Active"}):Object(V.jsx)(_.a,{color:"red",children:"Inactive"})},{title:"Acciones",dataIndex:"id",render:(e,n)=>Object(V.jsxs)(v.a,{children:[Object(V.jsx)(x.a,{type:"text",onClick:()=>a(n),icon:Object(V.jsx)(w.l,{})}),Object(V.jsx)(S.a,{type:"link",onClick:()=>t({id:e}),icon:Object(V.jsx)(w.h,{}),confirmText:"Desea eliminar?"}),n.type===N[0].id&&Object(V.jsx)(x.a,{type:"text",onClick:()=>i({id:e,name:null===n||void 0===n?void 0:n.name}),icon:Object(V.jsx)(w.m,{})})]})}]};var L=e=>{let{getBanners:t}=e;const[a]=h.a.useForm(),i=h.a.useWatch("id",a),n=h.a.useWatch("action_type",a),l=Object(C.b)("menu-banners"),[s,d]=Object(r.useState)(!1),[v,x]=Object(r.useState)(),[_,O]=Object(r.useState)(!1),[g,k]=Object(r.useState)(!1);return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(y.b,{custom:!0,source:"menu-banners",filterDefaultValues:{$sort:{id:-1}},searchField:"name",searchText:"Banners...",search:!0,permitFetch:!0,actions:{},updateSource:_,columns:H({onRemove:async e=>{let{id:t}=e;await l.remove(t).then(()=>{j.b.success("Banner eliminado!"),O(!_)}).catch(e=>j.b.error("No se pudo eliminar el banner! "+(null===e||void 0===e?void 0:e.message)))},onEdit:e=>{x(Object(p.a)({},f.a.mapValues(e,e=>{if(null!==e)return e}))),d(!0)},onWatch:e=>{x(e),k(!0)}}),extra:Object(V.jsx)("div",{children:Object(V.jsx)(F.a,{type:"primary",icon:Object(V.jsx)(w.u,{}),onClick:()=>{d(!0),x(),a.resetFields()},children:"Agregar"})})}),s&&Object(V.jsx)(o.a,{title:"".concat(i?"Editar":"Crear"," Banner"),placement:"right",visible:s,onClose:()=>{d(!1),x()},children:Object(V.jsxs)(q.a,{form:a,textAcceptButton:"Guardar",onSubmit:async(e,n)=>{if(e)return j.b.error(e);delete n.path_image;const{id:r}=n,s=Object(b.a)(n,D);i?await l.patch(i,Object(p.a)({},s)).then(()=>{j.b.success("Banner actualizado!"),d(!1),x(),a.resetFields(),O(!_),t()}).catch(e=>j.b.error(e.message)):await l.create(Object(p.a)({},s)).then(()=>{j.b.success("Banner Creado!"),d(!1),x(),a.resetFields(),O(!_),t()}).catch(e=>j.b.error(e.message))},initialValues:v,children:[Object(V.jsx)(m.a,{type:"hidden",name:"id"}),i&&(null===v||void 0===v?void 0:v.path_image)&&Object(V.jsx)(I.a,{refresh:(e,t)=>{x(Object(p.a)({},t)),a.setFieldsValue(Object(p.a)({},f.a.mapValues(t,e=>{if(null!==e)return e}))),O(!_)},size:"large",record:v,source:"path_image",defaultImage:v.path_image,withCropper:!0,setterVisibleCropper:()=>{},reference:"banners",_id:i,path:"apparta-menu/modals/"}),i&&Object(V.jsx)(z.b,{flex:1,preview:!1,path:"apparta-menu/modals/",name:"path_image",source:"path_image",style:{borderRadius:"0.5rem"},onFinish:(e,t)=>((e,t,i,n)=>{l.patch(n,{[e]:String(t)}).then(e=>{x(Object(p.a)({},e)),a.setFieldsValue(Object(p.a)({},f.a.mapValues(e,e=>{if(null!==e)return e}))),O(!_)}).catch(e=>j.b.error(e.message))})("path_image",e,0,i)}),Object(V.jsx)(m.a,{flex:1,name:"name",label:"Nombre",size:"large",validations:[{required:!0,message:"Nombre es requerido"}]}),Object(V.jsx)(u.a,{flex:1,name:"action_type",label:"Tipo de acci\xf3n",size:"large",validations:[{required:!0,message:'Tipo de acci\xf3n" es requerido'}],children:f.a.map($,(e,t)=>{let{id:a,name:i}=e;return Object(V.jsx)(u.a.Option,{value:a,children:i},t)})}),n===$[0].id&&Object(V.jsx)(u.a,{flex:1,name:"action_screen",label:"Acci\xf3n Pantalla",size:"large",validations:[{required:!0,message:"Acci\xf3n es requerida"}],children:f.a.map(M,(e,t)=>{let{id:a,name:i}=e;return Object(V.jsx)(u.a.Option,{value:a,children:i},t)})}),n===$[0].id&&Object(V.jsx)(c.a,{flex:1,name:"action_screen_id",label:"Acci\xf3n pantalla id",size:"large",validations:[{required:!0,message:"Id requerido"}]}),Object(V.jsx)(m.a,{flex:1,name:"external_link",size:"large",label:"Link externo",validations:[{required:!0,message:"Link es requerido"}]}),Object(V.jsx)(u.a,{flex:.5,name:"type",label:"Tipo",size:"large",validations:[{required:!0,message:"Tipo es requerido"}],children:f.a.map(N,(e,t)=>{let{id:a,name:i}=e;return Object(V.jsx)(u.a.Option,{value:a,children:i},t)})}),Object(V.jsx)(u.a,{flex:.5,name:"location_screen",label:"Ubicaci\xf3n",size:"large",validations:[{required:!0,message:"Ubicaci\xf3n es requerida"}],children:f.a.map(Y,(e,t)=>{let{id:a,name:i}=e;return Object(V.jsx)(u.a.Option,{value:a,children:i},t)})}),Object(V.jsx)(u.a,{flex:1,name:"status",label:"Estado",size:"large",validations:[{required:!0,message:"Estado es requerido"}],children:f.a.map(P,(e,t)=>{let{id:a,name:i}=e;return Object(V.jsx)(u.a.Option,{value:a,children:i},t)})})]})}),g&&Object(V.jsx)(B,{modalVisible:g,onCancel:()=>{k(!1),x()},selectedBannerProgramming:v})]})},J=(a(371),a(374)),R=a(144),W=a.n(R),G=a(380),U=a(383);const K=[{id:"active",name:"Active"},{id:"inactive",name:"Inactive"}],Q=e=>{let{cities:t,banners:a}=e;return[{dataIndex:"id",key:"id",title:"Id",sorter:!0},{dataIndex:"menu_banner_id",key:"menu_banner_id",title:"Banner",sorter:!0,render:e=>{var t;return(null===(t=f.a.find(a,t=>{let{id:a}=t;return a===e}))||void 0===t?void 0:t.name)||e}},{dataIndex:"date_time_start",key:"date_time_start",title:"Fecha Inicio",sorter:!0,render:e=>W()(e).format("YYYY-MM-DD h:mm a")},{dataIndex:"date_time_end",key:"date_time_end",title:"Fecha Fin",sorter:!0,render:e=>W()(e).format("YYYY-MM-DD h:mm a")},{dataIndex:"city_id",key:"city_id",title:"Ciudad",render:e=>{var a;return(null===(a=f.a.find(t,t=>{let{id:a}=t;return e===a}))||void 0===a?void 0:a.name)||e}},{dataIndex:"status",title:"Estado",sorter:!0,render:e=>"active"===e?Object(V.jsx)(_.a,{color:"green",children:"Active"}):Object(V.jsx)(_.a,{color:"red",children:"Inactive"})}]};var X=e=>{let{banners:t,loadingBanners:a}=e;const i=Object(C.b)("menu-banner-schedule"),[n,l]=Object(r.useState)(!1),[s,d]=Object(r.useState)(!1),[c,m]=Object(r.useState)(),[b,h]=Object(r.useState)(),[_,O]=Object(U.a)();return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(y.b,{filterDefaultValues:{city_id:b,$sort:{id:-1}},columns:[...Q({cities:_,banners:t}),{title:"Acciones",dataIndex:"id",render:(e,t)=>Object(V.jsxs)(v.a,{children:[Object(V.jsx)(x.a,{type:"text",onClick:()=>{return e=t,m(Object(p.a)(Object(p.a)({},e),{},{date_time_start:W()(e.date_time_start),date_time_end:W()(W()(e.date_time_end))})),void d(!0);var e},icon:Object(V.jsx)(w.l,{})}),Object(V.jsx)(S.a,{type:"link",onClick:()=>(async e=>{let{id:t}=e;await i.remove(t).then(()=>{j.b.success("Programaci\xf3n Eliminada!"),l(!n)}).catch(e=>j.b.error(e.message))})({id:e}),icon:Object(V.jsx)(w.h,{}),confirmText:"Desea eliminar?"})]})}],source:"menu-banner-schedule",actions:{},updateSource:n,extra:Object(V.jsx)(V.Fragment,{children:Object(V.jsx)(F.a,{icon:Object(V.jsx)(w.u,{}),type:"primary",onClick:()=>d(!0),children:"Agregar"})}),title:Object(V.jsx)(u.a,{allowClear:!0,placeholder:"Ciudad",loading:O,onChange:e=>h(e),onClear:()=>h(),style:{width:"15rem"},children:f.a.map(_,(e,t)=>{let{id:a,name:i}=e;return Object(V.jsx)(u.a.Option,{value:a,children:i},t)})})}),s&&Object(V.jsx)(o.a,{title:"Programar Banner en Apparta Menu",placement:"right",visible:s,onClose:()=>{d(!1),m(void 0)},children:Object(V.jsxs)(z.d,{scrollToFirstError:!0,allowNull:!0,initialValues:c,textAcceptButton:"Guardar",onSubmit:async(e,t,a)=>{if(e)return j.b.error(e);t.date_time_start&&(t.date_time_start=W()(t.date_time_start).utc().format()),t.date_time_end&&(t.date_time_end=W()(t.date_time_end).utc().format()),c?await i.patch(c.id,Object(p.a)({},t)).then(()=>{j.b.success("Programaci\xf3n actualizada!"),d(!1),m(),l(!n)}).catch(e=>j.b.error(e.message)):await i.create(Object(p.a)({},t)).then(()=>{j.b.success("Programaci\xf3n Creada!"),d(!1),l(!n)}).catch(e=>j.b.error(e.message))},children:[Object(V.jsx)(u.a,{flex:1,name:"menu_banner_id",label:"Banner",size:"large",validations:[{required:!0,message:"Banner es requerido"}],loading:a,showSearch:!0,optionFilterProp:"children",filterOption:(e,t)=>t.children.toLowerCase().includes(e.toLowerCase()),children:f.a.map(t,(e,t)=>{let{id:a,name:i}=e;return Object(V.jsx)(u.a.Option,{value:a,children:i},t)})}),Object(V.jsx)(J.a,{flex:1,locale:G.a,showTime:!0,size:"large",name:"date_time_start",label:"Fecha inicio",use12Hours:!0,secondStep:60,validations:[{required:!0,message:"Fecha Inicio es requerida"}]}),Object(V.jsx)(J.a,{flex:1,locale:G.a,showTime:!0,size:"large",name:"date_time_end",label:"Fecha fin",use12Hours:!0,secondStep:60,validations:[{required:!0,message:"Fecha Fin es requerida"}]}),Object(V.jsx)(u.a,{flex:1,name:"city_id",label:"Ciudad",size:"large",allowClear:!0,children:f.a.map(_,(e,t)=>{let{id:a,name:i}=e;return Object(V.jsx)(u.a.Option,{value:a,children:i},t)})}),Object(V.jsx)(u.a,{flex:1,name:"status",label:"Estado",size:"large",validations:[{required:!0,message:"Estado es requerido"}],children:f.a.map(K,(e,t)=>{let{id:a,name:i}=e;return Object(V.jsx)(u.a.Option,{value:a,children:i},t)})})]})})]})},Z=a(6);const ee=[{id:"active",name:"Activo"},{id:"inactive",name:"Inactivo"}],te=e=>{let{onRemove:t,onEdit:a,onWatch:i}=e;return[{title:"Id",dataIndex:"id",key:"id",sorter:!0},{title:"Nombre",dataIndex:"name",key:"name",sorter:!0},{title:"Slug",dataIndex:"slug",key:"slug",sorter:!0},{title:"Estado",dataIndex:"status",key:"status",sorter:!0,render:e=>Object(V.jsxs)(_.a,{color:"active"===e?"success":"error",children:[" ",e]})},{title:"Acciones",dataIndex:"id",render:(e,i)=>Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(x.a,{type:"text",onClick:()=>navigate("/dashboard/management/menu-banners/profile-group-details",{state:{menu_link_tree_group_id:e,menu_link_tree_group_name:null===i||void 0===i?void 0:i.name}}),icon:Object(V.jsx)(w.m,{})}),Object(V.jsx)(x.a,{type:"text",onClick:()=>a(i),icon:Object(V.jsx)(w.l,{})}),Object(V.jsx)(S.a,{type:"link",onClick:()=>t({id:e}),icon:Object(V.jsx)(w.h,{}),confirmText:"Desea eliminar?"})]})}]};var ae=()=>{Object(Z.q)();const e=Object(C.b)("menu-linktree-groups"),[t,a]=Object(r.useState)(!1),[i,n]=Object(r.useState)(!1),[l,s]=Object(r.useState)(),d=(i,n,r,l)=>{e.patch(l,{[i]:String(n)}).then(e=>{s(Object(p.a)({},e)),a(!t)}).catch(e=>j.b.error(e.message))};return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(y.b,{custom:!0,source:"menu-linktree-groups",filterDefaultValues:{$sort:{id:-1}},searchField:"name",searchText:"Grupo...",search:!0,permitFetch:!0,actions:{},updateSource:t,columns:te({onRemove:async i=>{let{id:n}=i;await e.remove(n).then(()=>{j.b.success("Grupo eliminado!"),a(!t)}).catch(e=>j.b.error("No se pudo eliminar el Grupo! "+(null===e||void 0===e?void 0:e.message)))},onEdit:e=>{s(e),n(!0)},onWatch:e=>{s(e)}}),extra:Object(V.jsx)("div",{children:Object(V.jsx)(F.a,{icon:Object(V.jsx)(w.u,{}),type:"primary",onClick:()=>n(!0),children:"Agregar"})})}),i&&Object(V.jsx)(o.a,{title:"".concat(l?"Editar":"Crear"," Banner"),placement:"right",visible:i,onClose:()=>{n(!1),s()},children:Object(V.jsxs)(z.d,{textAcceptButton:"Guardar",initialValues:l,onSubmit:async(i,r,d)=>{if(i)return j.b.error(i);delete r.cover_path,delete r.background_path,delete r.logo_path,l&&l.id?await e.patch(l.id,r).then(()=>{j.b.success("Grupo actualizada!"),n(!1),s(),a(!t)}).catch(e=>j.b.error(e.message)):await e.create(r).then(()=>{j.b.success("Grupo creada!"),n(!1),a(!t)}).catch(e=>j.b.error(e.message))},children:[(null===l||void 0===l?void 0:l.id)&&(null===l||void 0===l?void 0:l.logo_path)&&Object(V.jsx)(I.a,{refresh:(e,i)=>{s(Object(p.a)({},i)),a(!t)},size:"large",record:l,defaultImage:null===l||void 0===l?void 0:l.logo_path,source:"logo_path",withCropper:!0,setterVisibleCropper:()=>{},reference:"menu-linktree-groups",_id:l.id,path:"group_logo_path/".concat(+(null===l||void 0===l?void 0:l.id))}),(null===l||void 0===l?void 0:l.id)&&Object(V.jsx)(z.b,{flex:1,preview:!1,title:"Logo",path:"group_logo_path/".concat(l.id,"/"),name:"logo_path",source:"logo_path",style:{borderRadius:"0.5rem"},onFinish:(e,t)=>d("logo_path",e,0,l.id)}),(null===l||void 0===l?void 0:l.id)&&(null===l||void 0===l?void 0:l.background_path)&&Object(V.jsx)(I.a,{refresh:(e,i)=>{s(Object(p.a)({},i)),a(!t)},size:"large",record:l,defaultImage:null===l||void 0===l?void 0:l.background_path,source:"background_path",withCropper:!0,setterVisibleCropper:()=>{},reference:"menu-linktree-groups",_id:l.id,path:"group_background_path/".concat(+(null===l||void 0===l?void 0:l.id))}),(null===l||void 0===l?void 0:l.id)&&Object(V.jsx)(z.b,{flex:1,preview:!1,title:"Fondo",path:"group_background_path/".concat(l.id,"/"),name:"background_path",source:"background_path",style:{borderRadius:"0.5rem"},onFinish:(e,t)=>d("background_path",e,0,l.id)}),(null===l||void 0===l?void 0:l.id)&&(null===l||void 0===l?void 0:l.cover_path)&&Object(V.jsx)(I.a,{refresh:(e,i)=>{s(Object(p.a)({},i)),a(!t)},size:"large",record:l,defaultImage:null===l||void 0===l?void 0:l.cover_path,source:"cover_path",withCropper:!0,setterVisibleCropper:()=>{},reference:"menu-linktree-groups",_id:l.id,path:"group_cover_path/".concat(+(null===l||void 0===l?void 0:l.id))}),(null===l||void 0===l?void 0:l.id)&&Object(V.jsx)(z.b,{flex:1,preview:!1,title:"Portada",path:"group_cover_path/".concat(l.id,"/"),name:"cover_path",source:"cover_path",style:{borderRadius:"0.5rem"},onFinish:(e,t)=>d("cover_path",e,0,l.id)}),Object(V.jsx)(m.a,{flex:1,name:"name",label:"Nombre",size:"large",validations:[{required:!0,message:"Nombre es requerido"}]}),Object(V.jsx)(m.a.TextArea,{flex:1,name:"description",label:"Descripci\xf3n",autoSize:!0,validations:[{required:!0,message:"Descripci\xf3n es requerido"}]}),Object(V.jsx)(m.a,{flex:1,name:"sn_facebook",label:"FaceBook",size:"large"}),Object(V.jsx)(m.a,{flex:1,name:"sn_instagram",label:"Instagram",size:"large"}),Object(V.jsx)(m.a,{flex:1,name:"sn_tiktok",label:"Tik Tok",size:"large"}),Object(V.jsx)(u.a,{flex:1,name:"status",label:"Estado",size:"large",validations:[{required:!0,message:"Estado es requerido"}],children:f.a.map(ee,(e,t)=>{let{id:a,name:i}=e;return Object(V.jsx)(u.a.Option,{value:a,children:i},t)})})]})})]})};t.default=e=>{var t;let{location:a}=e;const o=(null===a||void 0===a||null===(t=a.state)||void 0===t?void 0:t.defaultSelectedTab)||"1",c=Object(l.d)(e=>{var t;let{dashboardReducer:a}=e;return null===(t=a.establishmentFilters)||void 0===t?void 0:t.establishment_id}),[u,m,b]=(()=>{const e=Object(C.b)("menu-banners"),[t,a]=Object(r.useState)([]),[i,n]=Object(r.useState)(!1),l=()=>{n(!0),e.find({query:{status:"active",$limit:1e5,$select:["id","name"]}}).then(e=>{let{data:t}=e;a(t),n(!1)}).catch(e=>{j.b.error(e.message),a([]),n(!1)})};return Object(r.useEffect)(()=>{l()},[]),[t,i,l]})();return Object(V.jsx)(i.a.Content,{style:{height:"100%",overflow:"auto",padding:"2rem"},children:Object(V.jsxs)(s.b,{defaultActiveKey:o,children:[Object(V.jsx)(n.a.TabPane,{tab:"Banners de Apparta Menu",children:Object(V.jsx)(L,{getBanners:b})},"1"),Object(V.jsx)(n.a.TabPane,{tab:"Banners programaci\xf3n",children:Object(V.jsx)(X,{banners:u,loadingBanners:m})},"2"),Object(V.jsx)(n.a.TabPane,{tab:"Perfil de grupos",children:Object(V.jsx)(ae,{})},"3"),[1,1996].includes(c)?Object(V.jsx)(n.a.TabPane,{tab:"Pop-ups de sistema",children:Object(V.jsx)(d.a,{})},"4 "):null]})})}},364:function(e,t,a){"use strict";a.d(t,"a",function(){return m}),a.d(t,"b",function(){return b});a(377);var i,n,r,l,s,d=a(379),o=(a(351),a(352)),c=a(61),u=a(53);u.default.div(i||(i=Object(c.a)(["\n  display: flex;\n  justify-content: start;\n  align-items: baseline;\n  flex-wrap: wrap;\n\n  width:100%!important;\n\n  background-color:var(--gray-dark-1)!important;\n  color:#fff!important;\n\n  & .ant-checkbox-wrapper{\n    margin:0px 10px;\n  }\n  & h2{\n    color: #fff!important;\n    text-transform: uppercase!important;\n    padding: 4px 10px!important;\n    font-size: 16px!important;\n    vertical-align: middle!important;\n    margin-bottom: 0px!important;\n  }\n"]))),u.default.div(n||(n=Object(c.a)(["\n\n    position:relative;\n   \n    display: flex;\n    justify-content: start;\n    align-items: center;\n\n    & .container{\n      width: 34px;\n      position:relative;\n    }\n    & .container:hover .ant-btn{\n      display:inline-block;\n    }\n    & .ant-btn,.ant-btn:hover{\n      position: absolute;\n      left: 0;\n      top: 0;\n      z-index: 999;\n      height: 34px!important;\n      display: none;\n      width: 34px!important;\n      background: #0010214f!important;\n      color: #FFF!important;\n      font-weight: bold;\n      display:none;\n    }\n"]))),u.default.div(r||(r=Object(c.a)(["\n    display:flex;\n    justify-content: space-between;\n"])));const m=Object(u.default)(o.a)(l||(l=Object(c.a)(["\n  box-shadow: rgba(0, 0, 0, 0.1) 0px 4px 12px;\n  border-radius:1rem;\n  background: #fff ;\n  padding: 2rem;\n"]))),b=Object(u.default)(d.a)(s||(s=Object(c.a)(["\n    & .ant-tabs-nav{\n        background-color:white;\n        border-radius:1rem;\n        box-shadow: rgb(0 0 0 / 10%) 0px 4px 12px;\n        padding:0 1rem;\n    }\n"])))},383:function(e,t,a){"use strict";a.d(t,"a",function(){return l});a(218);var i=a(69),n=a(0),r=a(68);const l=()=>{const e=Object(r.b)("cities"),[t,a]=Object(n.useState)([]),[l,s]=Object(n.useState)(!1);return Object(n.useEffect)(()=>{s(!0),e.find({query:{$limit:1e5,$sort:{name:1}}}).then(e=>{let{data:t}=e;a(t),s(!1)}).catch(e=>{i.b.error(e.message),a([]),s(!1)})},[]),[t,l]}},664:function(e,t,a){"use strict";a(366);var i=a(367),n=(a(394),a(393)),r=(a(354),a(355)),l=(a(436),a(438)),s=(a(371),a(374)),d=(a(357),a(358)),o=(a(219),a(361)),c=a(2),u=(a(218),a(69)),m=(a(386),a(387)),b=(a(351),a(352)),p=(a(143),a(142)),j=(a(372),a(373)),h=a(380),v=a(42),x=a.n(v),_=a(144),O=a.n(_),g=a(0),f=a(353),y=a(359),k=a(356),w=a(414),S=a(370),F=a(68),C=a(14);const q="h:mm a",I=[{id:"active",name:"Activo"},{id:"inactive",name:"Inactivo"}],z=[{day:"Lunes",id:0},{day:"Martes",id:1},{day:"Mi\xe9rcoles",id:2},{day:"Jueves",id:3},{day:"Viernes",id:4},{day:"S\xe1bado",id:5},{day:"Domingo",id:6},{day:"Festivos",id:7}],E=[{id:"all",name:"Una sola vez"},{id:"specific",name:"Recurrente"}],A=[{id:"all",name:"Mostrar en todos los establecimientos"},{id:"specific",name:"Mostrar en establecimientos espec\xedficos"}],T=[{id:"null",name:"Sin configurar"},{id:"5",name:"5 segundos"},{id:"30",name:"30 segundos"},{id:"60",name:"1 minuto"},{id:"300",name:"5 minutos"},{id:"900",name:"15 minutos"},{id:"1800",name:"30 minutos"},{id:"3600",name:"1 hora"},{id:"21600",name:"6 horas"}],V=e=>{let{onRemove:t,onEdit:a}=e;return[{title:"Nombre",dataIndex:"name",sorter:!0,width:200},{title:"Descripci\xf3n",dataIndex:"description",sorter:!0,width:200},{title:"Estado",dataIndex:"status",sorter:!0,width:100,render:e=>"active"===e?Object(C.jsx)(j.a,{color:"green",children:"Active"}):Object(C.jsx)(j.a,{color:"red",children:"Inactive"})},{title:"Establecimientos",dataIndex:"tables_partners",sorter:!0,width:"auto",render:(e,t)=>null!==t&&void 0!==t&&t.establishments_ids_included_information?x.a.map(JSON.parse(null===t||void 0===t?void 0:t.establishments_ids_included_information),(e,a)=>{let{full_name:i}=e;return Object(C.jsxs)("div",{children:[i,a+1===JSON.parse((null===t||void 0===t?void 0:t.establishments_ids_included_information)||[]).length?"":" , "]})}):""},{title:"Link",dataIndex:"link_url",sorter:!1},{title:"Acciones",dataIndex:"id",width:150,render:(e,i)=>Object(C.jsxs)(b.a,{children:[Object(C.jsx)(p.a,{type:"text",onClick:()=>a(i),icon:Object(C.jsx)(f.l,{})}),Object(C.jsx)(y.a,{type:"link",onClick:()=>t({id:e}),icon:Object(C.jsx)(f.h,{}),confirmText:"Desea eliminar?"})]})}]};t.a=e=>{let{location:t}=e;Object(F.b)("tables-partners-groups"),Object(F.b)("tables-partners");const a=Object(F.b)("establishments"),[j]=m.a.useForm(),_=m.a.useWatch("frequency",j),B=m.a.useWatch("targeting_scope",j),D=Object(F.b)("pop-ups"),[P,N]=Object(g.useState)(!1),[$,M]=Object(g.useState)(),[Y,H]=Object(g.useState)(!1),[L,J]=Object(g.useState)(),[R,W]=Object(g.useState)([]),[G,U]=Object(g.useState)([]),[K,Q]=Object(g.useState)(!1),[X,Z]=Object(g.useState)(1),ee=x.a.map(z,e=>{let{day:t,id:a}=e;return{value:Number(a||0)+1,label:t,checked:!1}}),[te,ae]=Object(g.useState)(ee),ie=Object(v.debounce)(async e=>{if(""===e)return W([]),void Z(1);await a.find({query:{q:e,$client:{skipJoins:!0},$limit:25,$select:["id","name"]}}).then(e=>{let{data:t}=e;const a=t.map(e=>{let{id:t,name:a}=e;return{establishment_id:t,full_name:a}});W(x.a.sortBy(a,[e=>{let{full_name:t}=e;return t}]))}).catch(e=>u.b.error(e))},500,{maxWait:800});Object(g.useEffect)(()=>{if(null!==$&&void 0!==$&&$.id){var e,t,a,i,n,r,l,s,d,o,u,m,b,p,h,v;if(null!==$&&void 0!==$&&null!==(e=$.pop_ups_schedules)&&void 0!==e&&null!==(t=e[0])&&void 0!==t&&t.day_of_week){const e=null===$||void 0===$?void 0:$.pop_ups_schedules.map(e=>{let{day_of_week:t}=e;return t}),t=ee.map(t=>Object(c.a)(Object(c.a)({},t),{},{checked:!!e.includes(null===t||void 0===t?void 0:t.value)}));ae(t),j.setFieldsValue({days_of_week:t.length?t.filter(e=>!0===e.checked):null})}if("date"===(null===$||void 0===$||null===(a=$.pop_ups_schedules)||void 0===a||null===(i=a[0])||void 0===i?void 0:i.period_type))j.setFieldValue("day",O()(null===$||void 0===$||null===(h=$.pop_ups_schedules)||void 0===h||null===(v=h[0])||void 0===v?void 0:v.date));if(j.setFieldValue("frequency","date"===(null===$||void 0===$||null===(n=$.pop_ups_schedules)||void 0===n||null===(r=n[0])||void 0===r?void 0:r.period_type)?"all":"specific"),j.setFieldValue("targeting_scope",null===$||void 0===$?void 0:$.targeting_scope),j.setFieldValue("reappear_interval_minutes",null!==$&&void 0!==$&&null!==(l=$.pop_ups_schedules)&&void 0!==l&&null!==(s=l[0])&&void 0!==s&&s.reappear_interval_minutes?"".concat(null===$||void 0===$||null===(d=$.pop_ups_schedules)||void 0===d||null===(o=d[0])||void 0===o?void 0:o.reappear_interval_minutes):"null"),j.setFieldValue("start_time",O()(null===$||void 0===$||null===(u=$.pop_ups_schedules)||void 0===u||null===(m=u[0])||void 0===m?void 0:m.start_time,"HH:mm:ss")),j.setFieldValue("end_time",O()(null===$||void 0===$||null===(b=$.pop_ups_schedules)||void 0===b||null===(p=b[0])||void 0===p?void 0:p.end_time,"hh:mm a")),null!==$&&void 0!==$&&$.establishments_ids_included_information){var x;const e=JSON.parse(null===$||void 0===$?void 0:$.establishments_ids_included_information);U({data:e,total:null===(x=e||[])||void 0===x?void 0:x.length})}}else j.setFieldValue("frequency","all"),j.setFieldValue("targeting_scope","specific"),j.setFieldValue("name",""),j.setFieldValue("description",""),j.setFieldValue("link_url","")},[null===$||void 0===$?void 0:$.id]);return Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(k.b,{custom:!0,source:"pop-ups",filterDefaultValues:{type:"system",$limit:1e3,$client:{showPopUpsSchedules:!0}},searchField:"q",searchText:"Pop-up...",search:!0,permitFetch:!0,actions:{},updateSource:Y,columns:V({onRemove:async e=>{let{id:t}=e;await D.remove(t).then(()=>{u.b.success("Pop-up eliminada!"),H(!Y)}).catch(e=>u.b.error("No se pudo eliminar el Sucursal! "+(null===e||void 0===e?void 0:e.message)))},onEdit:e=>{x.a.forEach(e,(t,a)=>{null===t&&delete e[a]}),M(e),N(!0)}}),extra:Object(C.jsx)("div",{children:Object(C.jsx)(S.a,{icon:Object(C.jsx)(f.u,{}),type:"primary",onClick:()=>{N(!0),M(),j.setFieldValue("frequency","all"),j.setFieldValue("targeting_scope","specific"),j.setFieldValue("reappear_interval_minutes","null"),ae(ee)},children:"Agregar"})})}),P&&Object(C.jsx)(i.a,{title:"".concat($?"Editar":"Crear"," Pop-up"),placement:"right",width:520,visible:P,onClose:()=>{j.resetFields(),M(),Z(1),U([]),W([]),setTimeout(()=>{N(!1)},500)},children:Object(C.jsxs)(w.a,{textAcceptButton:"Guardar",initialValues:$,onSubmit:async(e,t,a)=>{if(e)return u.b.error(e);try{var i,n,r;if(O()(null===t||void 0===t?void 0:t.end_time).isBefore(O()(null===t||void 0===t?void 0:t.start_time)))return void u.b.error("\xa1Ups! El rango de horario no es v\xe1lido");const e=null===t||void 0===t?void 0:t.frequency,l="all"===e?void 0:x.a.map(te.filter(e=>!0===(null===e||void 0===e?void 0:e.checked)),"value"),s=null===t||void 0===t||null===(i=t.start_time)||void 0===i?void 0:i.format("HH:mm:00"),d=null===t||void 0===t||null===(n=t.end_time)||void 0===n?void 0:n.format("HH:mm:00"),o="all"===e?O()(null===t||void 0===t?void 0:t.day).format("YYYY-MM-DD"):void 0,c={name:null===t||void 0===t?void 0:t.name,description:null===t||void 0===t?void 0:t.description,link_url:null===t||void 0===t?void 0:t.link_url,status:null===t||void 0===t?void 0:t.status,targeting_scope:null===t||void 0===t?void 0:t.targeting_scope,type:"system",establishments_ids_included:"all"===(null===t||void 0===t?void 0:t.targeting_scope)?null:JSON.stringify(null===G||void 0===G||null===(r=G.data)||void 0===r?void 0:r.map(e=>null===e||void 0===e?void 0:e.establishment_id)),establishments_ids_included_information:"all"===(null===t||void 0===t?void 0:t.targeting_scope)?null:JSON.stringify(null===G||void 0===G?void 0:G.data),meta_pop_ups_schedules:"all"===e?[{period_type:"date",date:o,start_time:s,end_time:d,reappear_interval_minutes:"null"!==(null===t||void 0===t?void 0:t.reappear_interval_minutes)?null===t||void 0===t?void 0:t.reappear_interval_minutes:void 0}]:x.a.map(l,e=>({period_type:"day_of_week",day_of_week:e,start_time:s,end_time:d,reappear_interval_minutes:"null"!==(null===t||void 0===t?void 0:t.reappear_interval_minutes)?null===t||void 0===t?void 0:t.reappear_interval_minutes:void 0}))};if($&&null!==$&&void 0!==$&&$.id){await D.patch(null===$||void 0===$?void 0:$.id,c);a.resetFields()}else{await D.create(c);a.resetFields()}U([]),M(),u.b.success("\xa1Pop-up creado exitosamente!."),setTimeout(()=>{H(!Y),N(!1)},500)}catch(l){console.log("error",l)}},form:j,children:[Object(C.jsx)(o.a,{flex:1,name:"name",label:"Nombre",validations:[{required:!0,message:"Nombre es requerido"}]}),Object(C.jsx)(o.a,{flex:1,name:"description",label:"Descripci\xf3n",validations:[{required:!0,message:"Descripci\xf3n es requerida"}]}),Object(C.jsx)(o.a,{flex:1,name:"link_url",label:"Link",validations:[{required:!0,message:"Link es requerido"}]}),Object(C.jsx)(d.a,{flex:.5,name:"reappear_interval_minutes",label:"Intervalo",size:"large",validations:[{required:!0,message:"Intervalo es requerido"}],children:x.a.map(T,(e,t)=>{let{id:a,name:i}=e;return Object(C.jsx)(d.a.Option,{value:a,children:i},t)})}),Object(C.jsx)(d.a,{flex:.5,name:"status",label:"Estado",size:"large",children:x.a.map(I,(e,t)=>{let{id:a,name:i}=e;return Object(C.jsx)(d.a.Option,{value:a,children:i},t)})}),Object(C.jsx)(d.a,{flex:1,disabled:null===$||void 0===$?void 0:$.id,name:"frequency",label:"Frecuencia",size:"large",validations:[{required:!0,message:"Frecuencia es requerida"}],children:x.a.map(E,(e,t)=>{let{id:a,name:i}=e;return Object(C.jsx)(d.a.Option,{value:a,children:i},t)})}),"all"===_?Object(C.jsx)(s.a,{flex:1,xtype:"date",size:"large",label:"Fecha",name:"day",format:"MM/DD/YYYY",locale:h.a}):null,"specific"===_?Object(C.jsx)("div",{style:{},children:Object(C.jsx)(m.a.Item,{name:"day_of_week",rules:[{required:!1}],label:"D\xedas de la semana",labelCol:{style:{}},children:Object(C.jsx)("div",{style:{display:"flex",gap:"5px",marginTop:"2px",flexWrap:"wrap"},children:x.a.map(te,e=>{let{value:t,label:a,checked:i}=e;return Object(C.jsx)(p.a,{type:i?"primary":"ghost",style:{minWidth:"100px",color:i?"white":"black"},onClick:async()=>{await(e=>{let{valueChecked:t}=e;const a=x.a.map(te,e=>e.value===t?Object(c.a)(Object(c.a)({},e),{},{checked:!e.checked}):e);ae(a);const i=a.filter(e=>!0===e.checked);j.setFieldsValue({day_of_week:i.length?i:null})})({valueChecked:t})},children:a})})})})}):null,Object(C.jsx)(l.a,{flex:.5,name:"start_time",label:"Hora inicio",use12Hours:!0,minuteStep:30,format:q,validations:[{required:!0,message:"Hora Inicio es requerida"}]}),Object(C.jsx)(l.a,{flex:.5,name:"end_time",label:"Hora fin",use12Hours:!0,minuteStep:30,format:q,validations:[{required:!0,message:"Hora Fin es requerida"}]}),Object(C.jsx)(d.a,{flex:1,name:"targeting_scope",label:"Alcance",size:"large",validations:[{required:!0,message:"Alcance es requerido"}],children:x.a.map(A,(e,t)=>{let{id:a,name:i}=e;return Object(C.jsx)(d.a.Option,{value:a,children:i},t)})}),"specific"===B?Object(C.jsxs)("div",{style:{width:"100%",gap:"4px"},children:[Object(C.jsxs)(b.a,{style:{width:"100%",gap:"4px",marginBottom:"8px"},children:[Object(C.jsx)(r.a,{flex:"auto",children:Object(C.jsx)(d.a,{showSearch:!0,label:"Establecimiento",placeholder:"A\xf1adir establecimiento",allowClear:!0,onSearch:ie,value:L,onClear:()=>J(),onSelect:e=>{J(e)},optionFilterProp:"children",style:{width:"100%"},filterOption:(e,t)=>t.children.toLowerCase().includes(e.toLowerCase()),children:x.a.map(R,(e,t)=>{let{establishment_branch_id:a,establishment_id:i,full_name:n}=e;return Object(C.jsx)(d.a.Option,{value:JSON.stringify({establishment_branch_id:a,establishment_id:i}),children:n},t)})})}),Object(C.jsx)(r.a,{flex:"none",children:Object(C.jsx)(y.a,{type:"primary",onClick:()=>(async e=>{var t;let{establishmentBranchSelected:a,tables_partners_groups_id:i}=e;const n=R.filter(e=>{var t;return e.establishment_id===(null===(t=JSON.parse(a))||void 0===t?void 0:t.establishment_id)}),r=((null===G||void 0===G?void 0:G.data)||[]).concat(n);U({data:r,total:null===(t=r||[])||void 0===t?void 0:t.length}),u.b.success("Establecimiento a\xf1adido correctamente!"),J(),H(!Y)})({establishmentBranchSelected:L,tables_partners_groups_id:null===$||void 0===$?void 0:$.id}),children:"A\xf1adir"})})]}),Object(C.jsx)(n.a,{style:{width:"100%"},loading:K,dataSource:(null===G||void 0===G?void 0:G.data)||[],columns:[{title:"Establecimiento",dataIndex:"full_name",key:"full_name",render:e=>e},{title:"Acciones",dataIndex:"establishment_id",key:"establishment_id",width:100,render:e=>Object(C.jsx)(y.a,{type:"link",onClick:()=>(e=>{let{id:t}=e;const a=G.data.filter(e=>e.establishment_id!==t);U({data:a,total:a.length}),u.b.success("Establecimiento eliminado correctamente!"),J(),H(!Y)})({id:e}),icon:Object(C.jsx)(f.h,{}),confirmText:"Desea eliminar?"})}],pagination:{current:X,showSizeChanger:!1,pageSize:9,onChange:e=>{Z(e)},total:(null===G||void 0===G?void 0:G.total)||0,showTotal:e=>"Total ".concat(e," record").concat(e>1?"s":"")}})]}):null]})})]})}}}]);
//# sourceMappingURL=43.875e4dc5.chunk.js.map