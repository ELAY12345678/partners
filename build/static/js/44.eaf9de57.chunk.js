(this["webpackJsonppartners-apparta"]=this["webpackJsonppartners-apparta"]||[]).push([[44],{1124:function(e,t,a){"use strict";a.r(t);a(362);var n=a(363),i=(a(377),a(379)),r=a(0),s=a(364),d=(a(366),a(367)),o=(a(371),a(374)),c=(a(368),a(369)),l=(a(357),a(358)),u=(a(220),a(361)),m=(a(219),a(69)),p=a(2),b=(a(143),a(142)),j=(a(372),a(373)),x=a(68),h=a(356),_=a(370),O=a(353),y=a(383),f=a(385),g=a.n(f),v=a(42),C=a.n(v),w=a(144),k=a.n(w),q=a(360),I=a(439),E=a(14);const z=[{id:"active",name:"Activo"},{id:"inactive",name:"Inactivo"}],S=[{id:"allBranches",name:"allBranches"},{id:"specificBranches",name:"specificBranches"}],A=[{id:"reservation",name:"Reserva"},{id:"num_persons",name:"Cada Persona"}],Y=[{id:"newUsers",name:"newUsers"},{id:"allUsers",name:"allUsers"},{id:"ByConditions",name:"ByConditions"}],F=e=>{let{onEdit:t,cities:a}=e;return[{dataIndex:"id",key:"id",title:"Id",sorter:!0},{dataIndex:"name",key:"name",title:"Nombre",sorter:!0},{dataIndex:"code",key:"code",title:"C\xf3digo del cup\xf3n",sorter:!0},{dataIndex:"code",key:"code",title:"C\xf3digo del cup\xf3n",sorter:!0},{dataIndex:"status",key:"status",title:"C\xf3digo del cup\xf3n",sorter:!0,render:e=>"active"===e?Object(E.jsx)(j.a,{color:"green",children:e}):Object(E.jsx)(j.a,{color:"red",children:e})},{dataIndex:"amount_campaign",key:"amount_campaign",title:"Campa\xf1a monto total",sorter:!0,render:e=>"$ ".concat(g()(e||"").format("0,0"))},{dataIndex:"amount_discount_per_use",key:"amount_discount_per_use",title:"Valor descuento",sorter:!0,render:e=>"$ ".concat(g()(e||"").format("0,0"))},{dataIndex:"use_type",key:"use_type",title:"Aplicar descuento a",sorter:!0,render:e=>{var t;return(null===(t=C.a.find(A,t=>{let{id:a}=t;return a===e}))||void 0===t?void 0:t.name)||e}},{dataIndex:"type",key:"type",title:"Aplica para",sorter:!0},{dataIndex:"city_id",key:"city_id",title:"Ciudad",render:e=>{var t;return(null===(t=C.a.find(a,t=>{let{id:a}=t;return e===a}))||void 0===t?void 0:t.name)||""}},{dataIndex:"start_date_time",key:"start_date_time",title:"Fecha inicio",sorter:!0,render:e=>k()(e).format("YYYY-MM-DD HH:mm")},{dataIndex:"end_date_time",key:"end_date_time",title:"Fecha fin",sorter:!0,render:e=>k()(e).format("YYYY-MM-DD HH:mm")},{dataIndex:"claims_by_user",key:"claims_by_user",title:"Usos por usuario",sorter:!0},{dataIndex:"condition_type",key:"condition_type",title:"Tipo de condici\xf3n",sorter:!0},{dataIndex:"condition_user_no_reservation_days",key:"condition_user_no_reservation_days",title:"Condici\xf3n: Usuarios sin reservas en x d\xedas",sorter:!0},{title:"Acciones",dataIndex:"id",key:"actions",render:(e,a)=>Object(E.jsx)(b.a,{type:"text",onClick:()=>t(a),icon:Object(E.jsx)(O.l,{})})}]};var T=()=>{const e=Object(x.b)("coupons"),[t,a]=Object(r.useState)(!1),[n,i]=Object(r.useState)(!1),[s,b]=Object(r.useState)(),[j,f]=Object(r.useState)(),[g,v]=Object(y.a)();return Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)(h.b,{source:"coupons",filterDefaultValues:{$sort:{id:1}},updateSource:t,columns:F({onEdit:e=>{b(Object(p.a)(Object(p.a)({},e),{},{start_date_time:k()(e.start_date_time),end_date_time:k()(e.end_date_time)})),f(null===e||void 0===e?void 0:e.condition_type),i(!0)},cities:g}),actions:{},searchField:"q",searchText:"Nombre",search:!0,filters:Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)(I.a,{alwaysOn:!0,source:"status",name:"status",label:"Estado",placeholder:"Estado",allowEmpty:!0,choices:z,size:"medium",style:{width:"15rem"}}),Object(E.jsx)(I.a,{alwaysOn:!0,source:"city_id",name:"city_id",label:"Ciudad",placeholder:"Ciudad",allowEmpty:!0,choices:g,size:"medium",loading:v,style:{width:"15rem"}}),Object(E.jsx)(I.a,{alwaysOn:!0,source:"condition_type",name:"condition_type",label:"Tipo de condici\xf3n",placeholder:"Tipo de condici\xf3n",allowEmpty:!0,choices:Y,size:"medium",style:{width:"15rem"}})]}),extra:Object(E.jsx)("div",{children:Object(E.jsx)(_.a,{type:"primary",icon:Object(E.jsx)(O.u,{}),onClick:()=>i(!0),children:"Agregar"})})}),n&&Object(E.jsx)(d.a,{width:520,title:"".concat(s?"Editar":"Crear"," cup\xf3n"),placement:"right",visible:n,onClose:()=>{i(!1),b(),f()},children:Object(E.jsxs)(q.d,{textAcceptButton:"Guardar",initialValues:s,onSubmit:async(n,r,d)=>{if(n)return m.b.error(n);r.start_date_time=r.start_date_time?k()(r.start_date_time).utc().format():void 0,r.end_date_time=r.end_date_time?k()(r.end_date_time).utc().format():void 0,s&&s.id?await e.patch(s.id,r).then(()=>{m.b.success("Cup\xf3n actualizado!"),b(),i(!1),a(!t)}).catch(e=>m.b.error(e.message)):await e.create(r).then(()=>{m.b.success("Cup\xf3n creado correctamente!"),i(!1),a(!t)}).catch(e=>m.b.error(e.message))},children:[Object(E.jsx)(u.a,{flex:1,name:"name",label:"Nombre",size:"large",validations:[{required:!0,message:"Nombre es requerido"}]}),Object(E.jsx)(u.a,{flex:1,name:"code",label:"C\xf3digo del cup\xf3n",size:"large",validations:[{required:!0,message:"C\xf3digo es requerido"}]}),Object(E.jsx)(l.a,{flex:.5,name:"status",label:"Estado",size:"large",validations:[{required:!0,message:"Estado es requerido"}],children:C.a.map(z,(e,t)=>{let{id:a,name:n}=e;return Object(E.jsx)(l.a.Option,{value:a,children:n},t)})}),Object(E.jsx)(c.a,{flex:.5,name:"amount_campaign",label:"Monto Total",size:"large",formatter:e=>"$ ".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:e=>e.replace(/\$\s?|(,*)/g,""),validations:[{required:!0,message:"Este campo es requerido"}]}),Object(E.jsx)(c.a,{flex:.5,name:"amount_discount_per_use",label:"Valor Descuento",size:"large",formatter:e=>"$ ".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:e=>e.replace(/\$\s?|(,*)/g,""),validations:[{required:!0,message:"Este campo es requerido"}]}),Object(E.jsx)(l.a,{flex:.5,name:"use_type",label:"Aplicar descuento a:",size:"large",validations:[{required:!0,message:"Este campo es requerido"}],children:C.a.map(A,(e,t)=>{let{id:a,name:n}=e;return Object(E.jsx)(l.a.Option,{value:a,children:n},t)})}),Object(E.jsx)(l.a,{flex:1,name:"type",label:"Aplica para",size:"large",validations:[{required:!0,message:"Este campo es requerido"}],children:C.a.map(S,(e,t)=>{let{id:a,name:n}=e;return Object(E.jsx)(l.a.Option,{value:a,children:n},t)})}),Object(E.jsx)(l.a,{flex:1,name:"city_id",label:"Ciudad",size:"large",validations:[{required:!0,message:"Ciudad es requerido"}],children:C.a.map(g,(e,t)=>{let{id:a,name:n}=e;return Object(E.jsx)(l.a.Option,{value:a,children:n},t)})}),Object(E.jsx)(o.a,{flex:.5,size:"large",name:"start_date_time",label:"Fecha Inicio",format:"YYYY-MM-DD HH:mm:ss",secondStep:60,showTime:!0,validations:[{required:!0,message:"Este campo es requerido"}]}),Object(E.jsx)(o.a,{flex:.5,size:"large",name:"end_date_time",label:"Fecha Fin",format:"YYYY-MM-DD HH:mm:ss",secondStep:60,showTime:!0,validations:[{required:!0,message:"Este campo es requerido"}]}),Object(E.jsx)(c.a,{flex:.5,size:"large",name:"claims_by_user",label:"Usos por usuario",validations:[{required:!0,message:"Este campo es requerido"}]}),Object(E.jsx)(l.a,{flex:.5,name:"condition_type",label:"Tipo de Condici\xf3n",size:"large",validations:[{required:!0,message:"Este campo es requerido"}],onChange:e=>f(e),children:C.a.map(Y,(e,t)=>{let{id:a,name:n}=e;return Object(E.jsx)(l.a.Option,{value:a,children:n},t)})}),Object(E.jsx)(c.a,{flex:.5,initial:0,min:0,size:"large",name:"condition_user_no_reservation_days",label:"Condici\xf3n: Usuarios sin reservas  x dias",validations:[{required:"ByConditions"===j,message:"Este campo es requerido"}]}),Object(E.jsx)(u.a.TextArea,{flex:1,name:"condition_terms",label:"T\xe9rminos",autoSize:!0,validations:[{required:!0,message:"Este campo es requerido"}]})]})})]})},D=a(359);const $=e=>{let{onEdit:t,onRemove:a,coupons:n}=e;return[{dataIndex:"id",key:"id",title:"Id",sorter:!0},{dataIndex:"coupon_id",key:"coupon_id",title:"Cup\xf3n Id",sorter:!0},{dataIndex:"establishment_branch_id",key:"establishment_branch_id",title:"Sucursal Id",sorter:!0},{dataIndex:"coupon_id",key:"coupon_id_name",title:"Cup\xf3n",sorter:!0,render:e=>{var t;return(null===(t=C.a.find(n,t=>{let{id:a}=t;return a===e}))||void 0===t?void 0:t.name)||e}},{title:"Acciones",dataIndex:"id",key:"actions",render:(e,n)=>Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)(b.a,{type:"text",onClick:()=>t(n),icon:Object(E.jsx)(O.l,{})}),Object(E.jsx)(D.a,{type:"link",onClick:()=>a({id:e}),icon:Object(E.jsx)(O.h,{}),confirmText:"Desea eliminar?"})]})}]};var B=()=>{const[e,t]=Object(r.useState)(!1),[a,n]=Object(r.useState)(!1),[i,s]=Object(r.useState)(),[o,l]=Object(r.useState)([]),[u,p]=Object(r.useState)([]),[b]=(e=>{const t=Object(x.b)("coupons"),[a,n]=Object(r.useState)([]);return Object(r.useEffect)(()=>{e&&t.find({query:{$limit:100,id:{$in:e},$select:["name","id"]}}).then(e=>{let{data:t}=e;n(t)})},[e]),[a]})(o);return Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)(h.b,{source:"coupons-establishment-branch",filterDefaultValues:{$sort:{id:1}},updateSource:e,columns:$({onEdit:e=>{s(e),n(!0)},onRemove:async a=>{let{id:n}=a;const i=Object(x.b)("coupons-establishment-branch");await i.remove(n).then(()=>{m.b.success("Cup\xf3n eliminado de la sucursal!"),t(!e)}).catch(e=>m.b.error("No se pudo eliminar el cup\xf3n! "+(null===e||void 0===e?void 0:e.message)))},coupons:b}),actions:{},extra:Object(E.jsx)("div",{children:Object(E.jsx)(_.a,{type:"primary",icon:Object(E.jsx)(O.u,{}),onClick:()=>n(!0),children:"Agregar"})}),returnToParentData:e=>{l(e.reduce((e,t)=>{let{coupon_id:a}=t;return e.includes(a)||e.push(a),e},[])),p(e.reduce((e,t)=>{let{establishment_branch_id:a}=t;return e.includes(a)||e.push(a),e},[]))},filters:Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)(c.a,{alwaysOn:!0,source:"coupon_id",name:"coupon_id",placeholder:"Cup\xf3n  Id",size:"medium",allowEmpty:!0,style:{width:"15rem"}}),Object(E.jsx)(c.a,{alwaysOn:!0,source:"establishment_branch_id",name:"establishment_branch_id",placeholder:"Sucursal  Id",size:"medium",allowEmpty:!0,style:{width:"15rem"}})]})}),a&&Object(E.jsx)(d.a,{title:"".concat(i?"Editar":"A\xf1adir"," cup\xf3n a la sucursal"),placement:"right",visible:a,onClose:()=>{n(!1),s()},children:Object(E.jsxs)(q.d,{source:"coupons-establishment-branch",id:null===i||void 0===i?void 0:i.id,textAcceptButton:"".concat(i?"Actualizar":"A\xf1adir"),initialValues:i,onSubmit:()=>{n(!1),t(!e),s()},children:[Object(E.jsx)(c.a,{flex:1,name:"coupon_id",label:"Cup\xf3n Id",size:"large",validations:[{required:!0,message:"Cup\xf3n Id es requerido"}]}),Object(E.jsx)(c.a,{flex:1,name:"establishment_branch_id",label:"Sucursal Id",size:"large",validations:[{required:!0,message:"Sucursal Id es requerida"}]})]})})]})};t.default=()=>Object(E.jsx)(n.a.Content,{style:{height:"100%",overflow:"auto",padding:"2rem"},children:Object(E.jsxs)(s.b,{defaultActiveKey:"1",children:[Object(E.jsx)(i.a.TabPane,{tab:"Cupones",children:Object(E.jsx)(T,{})},"1"),Object(E.jsx)(i.a.TabPane,{tab:"Cupones para sucursales",children:Object(E.jsx)(B,{})},"2")]})})},364:function(e,t,a){"use strict";a.d(t,"a",function(){return m}),a.d(t,"b",function(){return p});a(377);var n,i,r,s,d,o=a(379),c=(a(351),a(352)),l=a(61),u=a(53);u.default.div(n||(n=Object(l.a)(["\n  display: flex;\n  justify-content: start;\n  align-items: baseline;\n  flex-wrap: wrap;\n\n  width:100%!important;\n\n  background-color:var(--gray-dark-1)!important;\n  color:#fff!important;\n\n  & .ant-checkbox-wrapper{\n    margin:0px 10px;\n  }\n  & h2{\n    color: #fff!important;\n    text-transform: uppercase!important;\n    padding: 4px 10px!important;\n    font-size: 16px!important;\n    vertical-align: middle!important;\n    margin-bottom: 0px!important;\n  }\n"]))),u.default.div(i||(i=Object(l.a)(["\n\n    position:relative;\n   \n    display: flex;\n    justify-content: start;\n    align-items: center;\n\n    & .container{\n      width: 34px;\n      position:relative;\n    }\n    & .container:hover .ant-btn{\n      display:inline-block;\n    }\n    & .ant-btn,.ant-btn:hover{\n      position: absolute;\n      left: 0;\n      top: 0;\n      z-index: 999;\n      height: 34px!important;\n      display: none;\n      width: 34px!important;\n      background: #0010214f!important;\n      color: #FFF!important;\n      font-weight: bold;\n      display:none;\n    }\n"]))),u.default.div(r||(r=Object(l.a)(["\n    display:flex;\n    justify-content: space-between;\n"])));const m=Object(u.default)(c.a)(s||(s=Object(l.a)(["\n  box-shadow: rgba(0, 0, 0, 0.1) 0px 4px 12px;\n  border-radius:1rem;\n  background: #fff ;\n  padding: 2rem;\n"]))),p=Object(u.default)(o.a)(d||(d=Object(l.a)(["\n    & .ant-tabs-nav{\n        background-color:white;\n        border-radius:1rem;\n        box-shadow: rgb(0 0 0 / 10%) 0px 4px 12px;\n        padding:0 1rem;\n    }\n"])))},383:function(e,t,a){"use strict";a.d(t,"a",function(){return s});a(219);var n=a(69),i=a(0),r=a(68);const s=()=>{const e=Object(r.b)("cities"),[t,a]=Object(i.useState)([]),[s,d]=Object(i.useState)(!1);return Object(i.useEffect)(()=>{d(!0),e.find({query:{$limit:1e5,$sort:{name:1}}}).then(e=>{let{data:t}=e;a(t),d(!1)}).catch(e=>{n.b.error(e.message),a([]),d(!1)})},[]),[t,s]}}}]);
//# sourceMappingURL=44.eaf9de57.chunk.js.map