(this["webpackJsonppartners-apparta"]=this["webpackJsonppartners-apparta"]||[]).push([[55],{1115:function(e,t,a){"use strict";a.r(t);a(362);var r,i=a(363),s=(a(357),a(358)),n=a(2),l=(a(375),a(376)),d=(a(218),a(69)),c=(a(470),a(482)),o=(a(351),a(352)),j=(a(354),a(355)),b=(a(220),a(145)),h=a(0),m=a(42),u=a.n(m),O=a(62),x=a(356),p=a(144),g=a.n(p),f=a(353),v=a(61),_=a(53);const y=Object(_.default)(o.a)(r||(r=Object(v.a)(["\nbox-shadow: rgba(0, 0, 0, 0.1) 0px 4px 12px;\nborder-radius:1rem;\nbackground: #fff ;\npadding: 2rem;\n"])));var T=a(68);var k=a(643),G=a.p+"static/media/meal.b780dbe0.svg",w=a.p+"static/media/environment.1b153a9e.svg",z=a.p+"static/media/service.695d4257.svg",C=a.p+"static/media/cleaning.e906436f.svg",F=a.p+"static/media/time.2f4daf87.svg";var E=a(359),L=a(14);const q="admin",A=[{title:"Sucursal",dataIndex:"meta_establishment_branch_address",render:(e,t)=>{var a;return Object(L.jsx)(L.Fragment,{children:"".concat(e||(null===t||void 0===t||null===(a=t.establishment_branch)||void 0===a?void 0:a.address)||"")})},sorter:!0},{title:"Calificaci\xf3n",dataIndex:"rating_score",render:(e,t)=>Object(L.jsxs)(L.Fragment,{children:[e,Object(L.jsx)(f.C,{style:{color:"#f4cd4d"}})]}),sorter:!0,width:"150px"},{title:"Comentario",dataIndex:"rating_comment"},{title:"Fecha",dataIndex:"createdAt",render:(e,t)=>Object(L.jsx)(L.Fragment,{children:"".concat(g()(e).format("LL"))})}],S=e=>{let{number:t,percent:a}=e;return Object(L.jsxs)(o.a,{align:"middle",gutter:16,style:{width:"100%"},children:[Object(L.jsx)(j.a,{flex:"2rem",children:Object(L.jsx)(o.a,{justify:"center",children:Object(L.jsx)(j.a,{children:Object(L.jsx)(b.a.Text,{children:t})})})}),Object(L.jsx)(j.a,{flex:"none",style:{color:"#f4cd4d"},children:Object(L.jsx)(f.C,{size:25})}),Object(L.jsx)(j.a,{flex:"auto",children:Object(L.jsx)(c.a,{percent:a,strokeColor:a<=10?"#FF4B4B":a<=25?"#F4CD4D":"var(--purple)"})})]})},W=e=>{let{icon:t,title:a,rating:r}=e;return Object(L.jsx)(j.a,{flex:1,children:Object(L.jsx)(y,{children:Object(L.jsxs)(j.a,{span:24,children:[Object(L.jsxs)(o.a,{align:"middle",justify:"space-between",gutter:8,children:[Object(L.jsx)(j.a,{children:Object(L.jsx)("img",{src:t,alt:"icon rating",height:"45em"})}),Object(L.jsx)(j.a,{children:Object(L.jsxs)(o.a,{align:"middle",gutter:8,children:[Object(L.jsx)(j.a,{children:Object(L.jsx)(b.a.Title,{level:2,style:{margin:0},children:"string"===typeof r?null===r||void 0===r?void 0:r.substring(0,4):r||"0.0"})}),Object(L.jsx)(j.a,{children:Object(L.jsx)(o.a,{align:"middle",children:Object(L.jsx)(k.a,{size:30})})})]})})]}),Object(L.jsx)(o.a,{children:Object(L.jsx)(b.a.Title,{level:4,style:{margin:0,marginTop:"1rem"},children:a})})]})})})};t.default=()=>{const[e,t]=Object(h.useState)({}),[a,r]=Object(h.useState)(!1),c=Object(O.d)(e=>{let{dashboardReducer:t}=e;return t.establishmentFilters}),m=Object(O.d)(e=>{let{appReducer:t}=e;return null===t||void 0===t?void 0:t.user}),[p]=(e=>{let{establishment_id:t}=e;const[a,r]=Object(h.useState)("0.0");return Object(h.useEffect)(()=>{t?Object(T.b)("raw-queries/partners/establishments-ranting").find({query:{establishment_id:t,$client:{skipJoins:!0}}}).then(e=>{r(e.average_rating)}).catch(e=>r("0.0")):r("0.0")},[t]),[a]})({establishment_id:c.establishment_id}),[g]=(e=>{let{establishment_id:t,establishment_branch_id:a}=e;const r={"1.00":{key:"1",value:0},"2.00":{key:"2",value:0},"3.00":{key:"3",value:0},"4.00":{key:"4",value:0},"5.00":{key:"5",value:0}},[i,s]=Object(h.useState)(Object(n.a)({},r)),l=Object(T.b)("raw-queries/partners/establishments/ranting/details");return Object(h.useEffect)(()=>{t?l.find({query:{establishment_id:t,establishment_branch_id:a}}).then(e=>{let t=0,a=Object(n.a)({},r);u.a.forEach(e,e=>{let{rating_score:t}=e;a[t].value=0}),u.a.forEach(e,e=>{let{quantity:a}=e;t+=a}),u.a.forEach(e,e=>{let{rating_score:r,quantity:i}=e;a[r].value=100*i/t}),s(a)}).catch(e=>s(Object(n.a)({},r))):s(Object(n.a)({},r))},[a,t]),[i]})(c),[v]=(e=>{let{establishment_id:t,establishment_branch_id:a}=e;const[r,i]=Object(h.useState)();return Object(h.useEffect)(()=>{t?Object(T.b)("raw-queries/partners/establishments/ranting/details").find({query:{establishment_id:t,establishment_branch_id:a,$client:{detailsWithTypes:!0}}}).then(e=>{i(e)}).catch(e=>{d.b.error(e.message),i()}):i()},[t,a]),[r]})({establishment_id:c.establishment_id,establishment_branch_id:c.establishment_branch_id});return Object(L.jsxs)(i.a.Content,{style:{height:"100%",overflow:"auto",padding:"2rem"},children:[Object(L.jsxs)(o.a,{align:"middle",gutter:[16,16],children:[Object(L.jsx)(j.a,{children:Object(L.jsx)(k.a,{color:"var(--purple)"})}),Object(L.jsx)(j.a,{children:Object(L.jsx)(b.a.Title,{level:3,style:{margin:0},children:"Calificaciones"})})]}),Object(L.jsx)(l.a,{style:{background:"transparent",borderTop:0,marginTop:0}}),Object(L.jsxs)(y,{children:[Object(L.jsx)(j.a,{md:24,lg:12,children:Object(L.jsxs)(o.a,{gutter:16,children:[Object(L.jsxs)(j.a,{span:16,children:[Object(L.jsx)(b.a.Title,{level:5,children:"La calificaci\xf3n promedio de tu marca es:"}),Object(L.jsx)(b.a.Paragraph,{children:"El promedio de tu marca resulta de la suma del promedio de todas tus tiendas"})]}),Object(L.jsx)(j.a,{span:8,children:Object(L.jsxs)(o.a,{align:"middle",justify:"start",gutter:16,children:[Object(L.jsx)(j.a,{children:Object(L.jsx)(b.a.Title,{children:p})}),Object(L.jsx)(j.a,{children:Object(L.jsx)(k.a,{})})]})})]})}),Object(L.jsx)(j.a,{xs:24,sm:24,md:24,lg:12,children:u.a.map(g,(e,t)=>{let{key:a,value:r}=e;return Object(L.jsx)(S,{number:a,percent:r.toFixed(0)},t)})})]}),(null===c||void 0===c?void 0:c.establishment_id)&&Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(l.a,{style:{background:"transparent",borderTop:0,marginTop:0}}),Object(L.jsxs)(o.a,{gutter:[16,16],children:[Object(L.jsx)(W,{icon:G,title:"Comida",rating:null===v||void 0===v?void 0:v.food_rating}),Object(L.jsx)(W,{icon:w,title:"Ambiente",rating:null===v||void 0===v?void 0:v.environment_rating}),Object(L.jsx)(W,{icon:z,title:"Servicio",rating:null===v||void 0===v?void 0:v.service_rating}),Object(L.jsx)(W,{icon:C,title:"Limpieza",rating:null===v||void 0===v?void 0:v.hygiene_rating}),Object(L.jsx)(W,{icon:F,title:"Tiempo",rating:null===v||void 0===v?void 0:v.time_rating})]})]}),Object(L.jsx)(l.a,{style:{background:"transparent",borderTop:0,marginTop:0}}),c.establishment_id?Object(L.jsx)(x.b,{custom:!0,filterDefaultValues:Object(n.a)({establishment_id:c.establishment_id,establishment_branch_id:c.establishment_branch_id?c.establishment_branch_id:(null===m||void 0===m?void 0:m.role)===q?void 0:{$in:(e=>{const t=e.filter(e=>"establishments"===e.type),a=null===t||void 0===t?void 0:t.map(e=>{var t;if(e.establishment_id===Number(c.establishment_id))return null===e||void 0===e||null===(t=e.establishments_branchs)||void 0===t?void 0:t.map(e=>e.id)});return u.a.flattenDeep(a)})(null===m||void 0===m?void 0:m.permissionsv2)}},e),permitFetch:!u.a.isEmpty(c),title:Object(L.jsx)(b.a.Title,{level:4,children:"Tus calificaciones"}),style:{borderRadius:"0.5rem"},source:"establishment-ratings",columns:(null===m||void 0===m?void 0:m.role)===q?[...A,{title:"Acciones",dataIndex:"id",key:"actions",width:"150px",render:(e,t)=>Object(L.jsx)(E.a,{type:"link",onClick:()=>(async e=>{let{id:t}=e;const i=Object(T.b)("establishment-ratings");await i.remove(t).then(()=>{d.b.success("Calificaci\xf3n eliminada!"),r(!a)}).catch(e=>d.b.error("No se pudo eliminar la calificaci\xf3n! "+(null===e||void 0===e?void 0:e.message)))})({id:e}),icon:Object(L.jsx)(f.h,{}),confirmText:"Desea eliminar?"})}]:A,actions:{},extra:Object(L.jsxs)(o.a,{gutter:8,children:[Object(L.jsx)(j.a,{children:Object(L.jsx)(b.a.Title,{level:5,children:"Filtrar por:"})}),Object(L.jsx)(j.a,{children:Object(L.jsxs)(s.a,{defaultValue:"default",style:{width:120,borderRadius:"0.5rem"},disabled:u.a.isEmpty(c),onChange:e=>{t("default"===e?{rating_score:void 0}:{rating_score:e})},children:[Object(L.jsx)(s.a.Option,{value:"default",children:"todas"}),Object(L.jsx)(s.a.Option,{value:"5.00",children:"5 estrellas"}),Object(L.jsx)(s.a.Option,{value:"4.00",children:"4 estrellas"}),Object(L.jsx)(s.a.Option,{value:"3.00",children:"3 estrellas"}),Object(L.jsx)(s.a.Option,{value:"2.00",children:"2 estrellas"}),Object(L.jsx)(s.a.Option,{value:"1.00",children:"1 estrellas"})]})})]})}):Object(L.jsx)(y,{children:"*Selecciona un restaurante para ver los registros*"}),Object(L.jsx)(l.a,{style:{background:"transparent",borderTop:0,marginTop:0,marginBottom:"1rem"}})]})}},643:function(e,t,a){"use strict";var r=a(14);t.a=e=>{let{color:t,size:a}=e;return Object(r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:a||"41.413",height:a||"39.495",viewBox:"0 0 41.413 39.495",children:Object(r.jsxs)("g",{id:"star",transform:"translate(0.242 -11.735)",children:[Object(r.jsx)("g",{id:"Grupo_491","data-name":"Grupo 491",transform:"translate(5.102 14.148)",children:Object(r.jsx)("g",{id:"Grupo_490","data-name":"Grupo 490",transform:"translate(0 0)",children:Object(r.jsx)("path",{id:"Trazado_362","data-name":"Trazado 362",d:"M91.827,47.483,85.07,46.5l-3.022-6.123a3.184,3.184,0,0,0-5.709,0L73.317,46.5l-6.757.982a3.184,3.184,0,0,0-1.764,5.43l4.89,4.766-1.154,6.73a3.184,3.184,0,0,0,4.619,3.356l6.044-3.178,6.044,3.178a3.185,3.185,0,0,0,4.619-3.356L88.7,57.679l4.89-4.766A3.184,3.184,0,0,0,91.827,47.483Zm-.14,3.476-5.4,5.267a1.364,1.364,0,0,0-.392,1.208l1.276,7.437a.454.454,0,0,1-.66.479l-6.679-3.511a1.365,1.365,0,0,0-1.27,0L71.88,65.349a.454.454,0,0,1-.66-.479L72.5,57.433a1.364,1.364,0,0,0-.392-1.208l-5.4-5.267a.454.454,0,0,1,.252-.776L74.419,49.1a1.364,1.364,0,0,0,1.027-.746l3.339-6.766a.454.454,0,0,1,.816,0l3.339,6.766a1.364,1.364,0,0,0,1.027.746l7.467,1.085A.454.454,0,0,1,91.687,50.959Z",transform:"translate(-63.831 -38.604)",fill:t||"#f4cd4d",stroke:t||"#f4cd4d",strokeWidth:"0.4"})})}),Object(r.jsx)("g",{id:"Grupo_493","data-name":"Grupo 493",transform:"translate(6.67 12.023)",children:Object(r.jsx)("g",{id:"Grupo_492","data-name":"Grupo 492",transform:"translate(0 0)",children:Object(r.jsx)("path",{id:"Trazado_363","data-name":"Trazado 363",d:"M87.546,14.832l-1.632-2.246a1.364,1.364,0,0,0-2.207,1.6l1.632,2.246a1.364,1.364,0,0,0,2.207-1.6Z",transform:"translate(-83.446 -12.023)",fill:t||"#f4cd4d",stroke:t||"#f4cd4d",strokeWidth:"0.4"})})}),Object(r.jsx)("g",{id:"Grupo_495","data-name":"Grupo 495",transform:"translate(-0.001 34.014)",children:Object(r.jsx)("g",{id:"Grupo_494","data-name":"Grupo 494",transform:"translate(0)",children:Object(r.jsx)("path",{id:"Trazado_364","data-name":"Trazado 364",d:"M5.355,288.052a1.364,1.364,0,0,0-1.719-.876l-2.694.875a1.364,1.364,0,1,0,.843,2.6l2.694-.875A1.364,1.364,0,0,0,5.355,288.052Z",transform:"translate(0.001 -287.109)",fill:t||"#f4cd4d",stroke:t||"#f4cd4d",strokeWidth:"0.4"})})}),Object(r.jsx)("g",{id:"Grupo_497","data-name":"Grupo 497",transform:"translate(29.898 12.024)",children:Object(r.jsx)("g",{id:"Grupo_496","data-name":"Grupo 496",children:Object(r.jsx)("path",{id:"Trazado_365","data-name":"Trazado 365",d:"M377.807,12.286a1.364,1.364,0,0,0-1.906.3l-1.632,2.246a1.364,1.364,0,1,0,2.207,1.6l1.632-2.246A1.364,1.364,0,0,0,377.807,12.286Z",transform:"translate(-374.009 -12.025)",fill:t||"#f4cd4d",stroke:t||"#f4cd4d",strokeWidth:"0.4"})})}),Object(r.jsx)("g",{id:"Grupo_499","data-name":"Grupo 499",transform:"translate(35.506 34.014)",children:Object(r.jsx)("g",{id:"Grupo_498","data-name":"Grupo 498",children:Object(r.jsx)("path",{id:"Trazado_366","data-name":"Trazado 366",d:"M448.642,288.051l-2.694-.875a1.364,1.364,0,1,0-.843,2.6l2.694.875a1.364,1.364,0,1,0,.843-2.6Z",transform:"translate(-444.162 -287.108)",fill:t||"#f4cd4d",stroke:t||"#f4cd4d",strokeWidth:"0.4"})})}),Object(r.jsx)("g",{id:"Grupo_501","data-name":"Grupo 501",transform:"translate(19.1 45.533)",children:Object(r.jsx)("g",{id:"Grupo_500","data-name":"Grupo 500",children:Object(r.jsx)("path",{id:"Trazado_367","data-name":"Trazado 367",d:"M240.3,431.2a1.364,1.364,0,0,0-1.364,1.364v2.769a1.364,1.364,0,1,0,2.729,0v-2.769A1.364,1.364,0,0,0,240.3,431.2Z",transform:"translate(-238.934 -431.205)",fill:t||"#f4cd4d",stroke:t||"#f4cd4d",strokeWidth:"0.4"})})})]})})}}}]);
//# sourceMappingURL=55.1ef0af7c.chunk.js.map