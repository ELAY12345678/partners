(this["webpackJsonppartners-apparta"]=this["webpackJsonppartners-apparta"]||[]).push([[29,57],{1127:function(e,t,a){"use strict";a.r(t);a(362);var i=a(363),n=(a(143),a(142)),s=(a(375),a(376)),r=(a(351),a(352)),d=(a(221),a(145)),l=(a(354),a(355)),o=(a(219),a(69)),c=(a(357),a(358)),u=a(0),p=a(42),m=a.n(p),b=a(353),h=a.p+"static/media/discount2.b1b67ad8.svg",j=a(62),x=a(356),g=a(391),y=a(68),f=a(472);var O=a(560),v=a(561),_=a(359),w=(a(394),a(393)),C=(a(403),a(428)),S=(a(399),a(397)),k=a(2),z=a(12),q=(a(386),a(387)),E=(a(389),a(390)),T=a(144),I=a.n(T),D=a(660),F=a(380),A=a(679),M=a(360),R=a(661),P=a(54),H=a(14);const N=["discount_template_id","updateSource","setSelectedDiscount","isAdmin"],$=["id"],{confirm:Y}=E.a,V="h:mm a",B=[{name:"Lunes",id:"monday",key:1},{name:"Martes",id:"tuesday",key:2},{name:"Mi\xe9rcoles",id:"wednesday",key:3},{name:"Jueves",id:"thursday",key:4},{name:"Viernes",id:"friday",key:5},{name:"S\xe1bado",id:"saturday",key:6},{name:"Domingo",id:"sunday",key:7}],L=[{id:"fixed_amount",name:"Monto fijo",field:"only_read_fixed_amount_subsidized",formatValue:e=>"$ ".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,",")},{id:"percentage",name:"Porcentaje",field:"only_read_percentage_subsidized",formatValue:e=>"".concat(e,"%")}];var K=e=>{let{selectedTemplate:t,establishment_id:a,isAdmin:i}=e;const[d]=q.a.useForm(),c=q.a.useWatch("percentage_subsidized_calculator_type",d),p=Object(y.b)("discounts"),[h]=Object(D.a)({establishment_id:a}),[j]=Object(R.a)({establishment_id:a}),[x,g]=Object(u.useState)(!1),[O,v]=Object(u.useState)(),[E,T]=Object(u.useState)([]),[K,G]=Object(u.useState)(!1),U=e=>{G(!0),p.find({query:{discount_template_id:e,$limit:1e5,$sort:{start_hour:1}}}).then(e=>{let{data:t}=e;T(t),G(!1)}).catch(e=>{T([]),o.b.error(null===e||void 0===e?void 0:e.message),G(!1)})};return Object(u.useEffect)(()=>{U(t)},[t]),Object(H.jsxs)(r.a,{children:[i&&Object(H.jsxs)(H.Fragment,{children:[Object(H.jsx)(s.a,{style:{background:"transparent",borderTop:0}}),Object(H.jsxs)(r.a,{gutter:16,children:[Object(H.jsx)(l.a,{children:Object(H.jsx)(M.b,{preview:!1,path:"discount-templates/".concat(a,"/"),style:{borderRadius:"0.5rem"},title:"Importar plantilla",allowTypes:["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],onFinish:e=>(async(e,a)=>{await p.create({file_path:"/".concat(e),discount_template_id:a},{query:{$client:{importDiscounts:!0}}}).then(e=>{o.b.success(e.message),U(t)}).catch(e=>o.b.error(e.message))})(e,t)})}),Object(H.jsx)(l.a,{children:Object(H.jsx)(_.a,{type:"primary",size:"middle",style:{borderRadius:"0.5rem"},onClick:async()=>{await p.find({query:{discount_template_id:t,$client:{exportDiscounts:!0}}}).then(e=>window.open(e.path,"_blank")).catch(e=>{o.b.error(e.message)})},children:"Exportar plantilla"})})]}),Object(H.jsx)(s.a,{style:{background:"transparent",borderTop:0,marginTop:0}}),Object(H.jsx)(f.a,{form:d,initialValues:O,textAcceptButton:"+ Agregar descuento",noAcceptButtonBlock:!0,onSubmit:async(e,a,i)=>{if(e)return o.b.error(e);a.start_hour&&(a.start_hour=I()(I()(a.start_hour,V)).format("HH:mm:ss")),a.end_hour&&(a.end_hour=I()(I()(a.end_hour,V)).format("HH:mm:ss")),O?await p.patch(O.id,a).then(()=>{g(!x),v(),o.b.success("Descuento actualizado!")}).catch(e=>o.b.error("No se pudo actualizar el descuento!"+(null===e||void 0===e?void 0:e.message))):await p.create(Object(k.a)(Object(k.a)({},a),{},{discount_template_id:t})).then(()=>{o.b.success("Descuento Creado!"),g(!x),U(t)}).catch(e=>o.b.error("No se pudo crear el descuento! "+(null===e||void 0===e?void 0:e.message)))},fields:[{xtype:"selectfield",name:"day",choices:B,label:"D\xeda",validations:[{required:!0,message:"D\xeda es requerido"}],style:{width:"120px"}},{name:"start_hour",xtype:"timefield",label:"Hora Inicio",use12Hours:!0,minuteStep:P.e,format:"h:mm a",validations:[{required:!0,message:"Hora inicio requerida"}],size:"large"},{name:"end_hour",xtype:"timefield",label:"Hora Fin",use12Hours:!0,minuteStep:P.e,format:"h:mm a",validations:[{required:!0,message:"Hora fin requerida"}],size:"large"},{xtype:"numberfield",name:"quantity_available",label:"Cantidad",validations:[{required:!0,type:"number",message:"Cantidad debe ser num\xe9rico y es requerida"}],style:{width:"100px"}},{xtype:"numberfield",name:"percentage",label:"Porcentaje",addonAfter:Object(H.jsx)(H.Fragment,{children:"%"}),validations:[{required:!0,type:"number",message:"Porcentaje debe ser num\xe9rico y es requerido"}],style:{width:"100px"}},{xtype:"numberfield",label:"Min Personas",name:"min_persons",validations:[{required:!0,type:"number",message:"Min Personas debe ser num\xe9rico y es requerido"}],style:{width:"150px"}},{name:"max_persons",xtype:"numberfield",label:"Max Personas",validations:[{required:!0,type:"number",message:"Max Personas debe ser num\xe9rico y es requerido"}],style:{width:"150px"}},{xtype:"numberfield",label:"Max Reservaciones",name:"max_reservations",style:{width:"170px"}},{xtype:"selectfield",label:"Seleccione Oferta",name:"deal_id",choices:h,style:{width:"200px"}},{xtype:"selectfield",label:"C\xf3digos de terceros",name:"third_party_codes_list_id",choices:j,style:{width:"200px"}},{xtype:"selectfield",label:"Tipo de descuento Subsidiado",placeholder:"Tipo de descuento Subsidiado",name:"percentage_subsidized_calculator_type",choices:L},c===L[1].id&&{name:"only_read_percentage_subsidized",xtype:"numberfield",label:"% Subsidiado",formatter:e=>"".concat(e,"%"),parser:e=>e.replace("%",""),validations:[{required:!0,type:"number",message:"% Subsidiado debe ser num\xe9rico y es requerido"}]},c===L[0].id&&{name:"only_read_fixed_amount_subsidized",xtype:"numberfield",label:"Monto subsidiado",formatter:e=>"$ ".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:e=>e.replace(/\$\s?|(,*)/g,""),validations:[{required:!0,type:"number",message:"Monto subsidiado debe ser num\xe9rico y es requerido"}]}]})]}),Object(H.jsx)(s.a,{style:{background:"transparent",borderTop:0,marginTop:0}}),Object(H.jsx)(w.a,{style:{width:"100%"},showHeader:!1,dataSource:B,pagination:!1,expandedRowRender:e=>(e=>{let{discount_template_id:a,updateSource:i,setSelectedDiscount:s,isAdmin:d}=e,c=Object(z.a)(e,N);const u=e=>{Object(y.b)("copy-discounts-from-days-week").create(e).then(()=>{g(!i),U(t),o.b.success("D\xeda copiado con \xe9xito!")}).catch(e=>{o.b.error("No se pudo copiar el d\xeda! "+(null===e||void 0===e?void 0:e.message))})},x=Object(H.jsxs)(S.a,{selectable:!0,onClick:e=>{let t,i={discount_template_id:a,day_week_destination:c.id};const n=B.find(t=>t.id===e.key);n&&(i.day_week_origin=e.key,t=n.name),Y({title:"Desea copiar la programaci\xf3n?",content:Object(H.jsxs)(H.Fragment,{children:["Se copiaran los descuentos del d\xeda ",Object(H.jsxs)("strong",{children:[t," "]}),Object(H.jsx)("br",{}),"Este proceso remplazar\xe1 cualquier descuento que exista para ese d\xeda en la plantilla."]}),onOk(){u(i)}})},children:[Object(H.jsx)(S.a.Divider,{}),B.map(e=>Object(H.jsx)(S.a.Item,{children:Object(H.jsxs)("span",{children:[Object(H.jsx)(b.d,{})," ",e.name]})},e.id))]});return Object(H.jsxs)(r.a,{style:{margin:"10px 0px"},gutter:[16,16],children:[d&&Object(H.jsx)(l.a,{span:24,children:Object(H.jsx)(r.a,{gutter:4,type:"flex",justify:"end",align:"center",children:Object(H.jsx)(l.a,{children:Object(H.jsx)(C.a,{overlay:x,children:Object(H.jsx)(n.a,{children:"COPIAR D\xcdA"})})})})}),Object(H.jsx)(l.a,{span:24,children:Object(H.jsx)(A.a,{isAdmin:d,pagination:!1,onDelete:async e=>{let{id:a}=e;await p.remove(a).then(()=>{g(!i),U(t),o.b.success("Descuento Eliminado!")}).catch(e=>o.b.error("No se pudo eliminar el descuento, "+(null===e||void 0===e?void 0:e.message)))},onSubmit:async e=>{let{id:i}=e,n=Object(z.a)(e,$);n.start_hour&&(n.start_hour=I()(n.start_hour,V).format("HH:mm:ss")),n.end_hour&&(n.end_hour=I()(n.end_hour,V).format("HH:mm:ss")),n.inactive_until&&(n.inactive_until=I()(n.inactive_until).utc().format("YYYY-MM-DD HH:mm:ss")),await p.patch(i,Object(k.a)({discount_template_id:a},n)).then(()=>{G(!1),U(t),o.b.success("Descuento Actualizado")}).catch(e=>o.b.error("No se pudo actualizar el descuento! "+(null===e||void 0===e?void 0:e.message)))},dataSource:!K&&E.filter(e=>e.day===c.id),loading:K,columns:[{xtype:"timefield",dataIndex:"start_hour",editable:d,title:"Inicio",required:!0,render:e=>"".concat(I()(e,"hh:mm a").format("h:mm a"))},{xtype:"timefield",dataIndex:"end_hour",editable:d,title:"Fin",required:!0,render:e=>"".concat(I()(e,"hh:mm a").format("h:mm a"))},{xtype:"numberfield",dataIndex:"quantity_available",editable:d,title:"Cantidad",required:!0},{xtype:"numberfield",dataIndex:"percentage",editable:d,title:"%",formatter:e=>"".concat(e,"%"),parser:e=>e.replace("%",""),required:!0},{xtype:"numberfield",dataIndex:"max_persons",editable:d,title:"Max Personas",required:!0},{xtype:"numberfield",dataIndex:"max_reservations",editable:d,title:"Max Reservations"},{xtype:"selectfield",dataIndex:"percentage_subsidized_calculator_type",editable:d,title:"Tipo desc. Subsidiado",choices:L,allowClear:!0},{xtype:"numberfield",dataIndex:"only_read_percentage_subsidized",editable:d,required:!0,title:"% Subsidiado",formatter:e=>"".concat(e,"%"),parser:e=>e.replace("%",""),dependencyCondition:"percentage",dependencyField:"percentage_subsidized_calculator_type",render:(e,t)=>{const a=L[1];return a&&t[a.field]&&t.percentage_subsidized_calculator_type===a.id?a.formatValue(t[a.field]):""}},{xtype:"numberfield",dataIndex:"only_read_fixed_amount_subsidized",editable:d,required:!0,title:"Monto Subsidiado",formatter:e=>"$ ".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:e=>e.replace(/\$\s?|(,*)/g,""),dependencyCondition:"fixed_amount",dependencyField:"percentage_subsidized_calculator_type",render:(e,t)=>{const a=L[0];return a&&t[a.field]&&t.percentage_subsidized_calculator_type===a.id?a.formatValue(t[a.field]):""}},{xtype:"datefield",dataIndex:"inactive_until",editable:d,title:"Inactivo hasta",required:!1,render:e=>e?"".concat(I()(e).format("YYYY-MM-DD HH:mm:ss")):"",format:"YYYY-MM-DD HH:mm:ss",showTime:!0,locale:F.a},{xtype:"selectfield",dataIndex:"deal_id",choices:m.a.map(h,e=>({id:null===e||void 0===e?void 0:e.id,name:null===e||void 0===e?void 0:e.name})),editable:d,title:"Oferta",allowClear:!0},{xtype:"selectfield",dataIndex:"third_party_codes_list_id",choices:m.a.map(j,e=>({id:null===e||void 0===e?void 0:e.id,name:null===e||void 0===e?void 0:e.name})),editable:d,title:"C\xf3digos de terceros",allowClear:!0}]})})]})})(Object(k.a)(Object(k.a)({},e),{},{discount_template_id:t,updateSource:x,setSelectedDiscount:v,isAdmin:i})),columns:[{dataIndex:"name",key:"name"}]})]})};const G="admin",U=e=>{let{templates:t,handleChangeTemplate:a,isAdmin:i}=e;return[{title:"Sucursal",dataIndex:"address"},{title:"Plantilla asociada",dataIndex:"discount_template_id",render:(e,n)=>{var s,r;return i?Object(H.jsx)(c.a,{bordered:!1,style:{minWidth:"20rem"},value:(null===(s=m.a.find(t,t=>{let{id:a}=t;return a===e}))||void 0===s?void 0:s.name)||"Ninguna",onChange:e=>a({id:n.id,discount_template_id:e}),showSearch:!0,optionFilterProp:"children",filterOption:(e,t)=>t.children.toLowerCase().includes(e.toLowerCase()),children:m.a.map(t,(e,t)=>{let{id:a,name:i}=e;return Object(H.jsx)(c.a.Option,{value:a,children:i},t)})}):(null===(r=m.a.find(t,t=>{let{id:a}=t;return a===e}))||void 0===r?void 0:r.name)||"Ninguna"}}]};t.default=()=>{const e=Object(y.b)("establishments-branchs"),t=Object(y.b)("discount-templates"),a=Object(j.d)(e=>{var t;let{appReducer:a}=e;return null===a||void 0===a||null===(t=a.user)||void 0===t?void 0:t.role}),p=Object(j.d)(e=>{let{dashboardReducer:t}=e;return t.establishmentFilters}),w=Object(j.d)(e=>{var t;let{appReducer:a}=e;return null===a||void 0===a||null===(t=a.user)||void 0===t?void 0:t.permissionsv2}),[C,S]=(e=>{let{establishment_id:t}=e;const a=Object(y.b)("discount-templates"),[i,n]=Object(u.useState)([]),s=()=>{a.find({query:{$or:[{establishment_id:t},{type:"global"}],$limit:100,$sort:{name:1},$select:["id","name","type"]}}).then(e=>{let{data:t}=e;n(t)})};return Object(u.useEffect)(()=>{t?s():n([])},[t]),[i,s]})({establishment_id:p.establishment_id}),[k,z]=Object(u.useState)(),[q,E]=Object(u.useState)(),[T,I]=Object(u.useState)(!1);return Object(u.useEffect)(()=>{E()},[p]),Object(H.jsxs)(i.a.Content,{style:{height:"100%",overflow:"auto",padding:"2rem"},children:[Object(H.jsxs)(r.a,{children:[Object(H.jsxs)(r.a,{align:"middle",style:{color:"var(--purple)"},gutter:[16,16],children:[Object(H.jsx)(l.a,{children:Object(H.jsx)("img",{src:h,alt:"icon"})}),Object(H.jsx)(l.a,{children:Object(H.jsx)(d.a.Title,{level:3,style:{margin:0},children:"Plantillas de descuentos"})})]}),Object(H.jsx)(s.a,{style:{background:"transparent",borderTop:0}})]}),Object(H.jsx)(r.a,{children:Object(H.jsx)(d.a.Title,{level:5,children:"Sucursales"})}),p.establishment_id?Object(H.jsx)(x.b,{filterDefaultValues:{establishment_id:p.establishment_id,id:a===G?void 0:{$in:(e=>{const t=e.filter(e=>"establishments"===e.type),a=null===t||void 0===t?void 0:t.map(e=>{var t;if(e.establishment_id===Number(p.establishment_id))return null===e||void 0===e||null===(t=e.establishments_branchs)||void 0===t?void 0:t.map(e=>e.id)});return m.a.flattenDeep(a)})(w)},$sort:{address:1}},columns:U({templates:C,handleChangeTemplate:t=>{let{id:a,discount_template_id:i}=t;e.patch(a,{discount_template_id:i}).then(()=>{I(!T),o.b.success("Cambio de platilla exitoso!")}).catch(e=>o.b.error("No se cambio la plantilla! "+(null===e||void 0===e?void 0:e.message)))},isAdmin:a===G}),source:"establishments-branchs",permitFetch:!!p.establishment_id,actions:{},updateSource:T}):Object(H.jsx)(g.a,{children:"*Selecciona una direcci\xf3n para ver los registros*"}),Object(H.jsx)(s.a,{style:{background:"transparent",borderTop:0}}),Object(H.jsxs)(r.a,{justify:"space-between",children:[Object(H.jsx)(l.a,{children:Object(H.jsx)(d.a.Title,{level:5,children:"Plantilas"})}),a===G&&Object(H.jsx)(l.a,{children:Object(H.jsx)(n.a,{size:"large",type:"primary",block:!0,icon:Object(H.jsx)(b.u,{}),style:{borderRadius:"0.5rem"},disabled:!p.establishment_id,onClick:()=>z(!0),children:"Crear nueva plantilla"})})]}),Object(H.jsx)(s.a,{style:{background:"transparent",borderTop:0,marginTop:0}}),Object(H.jsxs)(g.a,{children:[Object(H.jsx)(l.a,{span:24,children:Object(H.jsxs)(r.a,{gutter:16,children:[Object(H.jsx)(l.a,{children:Object(H.jsxs)(c.a,{placeholder:"Seleccione plantilla para ".concat(a===G?"editar":"ver"),style:{minWidth:"18rem"},onChange:e=>E(e),value:q,disabled:!p.establishment_id,children:[Object(H.jsx)(c.a.Option,{value:null,children:"Ninguna"}),m.a.map(m.a.filter(C,e=>{let{type:t}=e;return"establishment"===t}),(e,t)=>{let{id:a,name:i}=e;return Object(H.jsx)(c.a.Option,{value:a,children:i},t)})]})}),a===G&&Object(H.jsxs)(H.Fragment,{children:[Object(H.jsx)(l.a,{children:Object(H.jsx)(n.a,{type:"text",icon:Object(H.jsx)("img",{src:O.a,alt:"Editar"}),disabled:!q})}),Object(H.jsx)(l.a,{children:Object(H.jsx)(_.a,{type:"text",confirmText:"Esta seguro de eliminar esta plantilla?",icon:Object(H.jsx)("img",{src:v.a,alt:"Eliminar"}),disabled:!q,onClick:()=>(async e=>{let{id:a}=e;await t.remove(a).then(()=>{S(),E(),o.b.success("Plantilla eliminada!")}).catch(e=>o.b.error("No se pudo eliminar! "+(null===e||void 0===e?void 0:e.message)))})({id:q})})})]})]})}),q&&Object(H.jsx)(l.a,{span:24,children:Object(H.jsx)(K,{selectedTemplate:q,establishment_id:p.establishment_id,isAdmin:a===G})})]}),Object(H.jsx)(x.c,{title:"Crear nueva plantilla",visible:k,onCancel:()=>z(!1),children:Object(H.jsx)(f.a,{source:"discount-templates",textAcceptButton:"Crear",fields:[{name:"establishment_id",xtype:"hidden",initial:p.establishment_id},{name:"type",xtype:"hidden",initial:"establishment"},{flex:1,name:"name",xtype:"textfield",label:"Escribe un nombre para tu plantilla",placeholder:"Ej: Master Discount",style:{borderRadius:"0.5rem"},validations:[{required:!0,message:"El Nombre es requerido"}]}],onSubmit:(e,t)=>{S(),z(!1)}})})]})}},364:function(e,t,a){"use strict";a.d(t,"a",function(){return p}),a.d(t,"b",function(){return m});a(377);var i,n,s,r,d,l=a(379),o=(a(351),a(352)),c=a(61),u=a(53);u.default.div(i||(i=Object(c.a)(["\n  display: flex;\n  justify-content: start;\n  align-items: baseline;\n  flex-wrap: wrap;\n\n  width:100%!important;\n\n  background-color:var(--gray-dark-1)!important;\n  color:#fff!important;\n\n  & .ant-checkbox-wrapper{\n    margin:0px 10px;\n  }\n  & h2{\n    color: #fff!important;\n    text-transform: uppercase!important;\n    padding: 4px 10px!important;\n    font-size: 16px!important;\n    vertical-align: middle!important;\n    margin-bottom: 0px!important;\n  }\n"]))),u.default.div(n||(n=Object(c.a)(["\n\n    position:relative;\n   \n    display: flex;\n    justify-content: start;\n    align-items: center;\n\n    & .container{\n      width: 34px;\n      position:relative;\n    }\n    & .container:hover .ant-btn{\n      display:inline-block;\n    }\n    & .ant-btn,.ant-btn:hover{\n      position: absolute;\n      left: 0;\n      top: 0;\n      z-index: 999;\n      height: 34px!important;\n      display: none;\n      width: 34px!important;\n      background: #0010214f!important;\n      color: #FFF!important;\n      font-weight: bold;\n      display:none;\n    }\n"]))),u.default.div(s||(s=Object(c.a)(["\n    display:flex;\n    justify-content: space-between;\n"])));const p=Object(u.default)(o.a)(r||(r=Object(c.a)(["\n  box-shadow: rgba(0, 0, 0, 0.1) 0px 4px 12px;\n  border-radius:1rem;\n  background: #fff ;\n  padding: 2rem;\n"]))),m=Object(u.default)(l.a)(d||(d=Object(c.a)(["\n    & .ant-tabs-nav{\n        background-color:white;\n        border-radius:1rem;\n        box-shadow: rgb(0 0 0 / 10%) 0px 4px 12px;\n        padding:0 1rem;\n    }\n"])))},381:function(e,t,a){"use strict";a(143);var i=a(142),n=(a(354),a(355)),s=(a(351),a(352)),r=(a(221),a(145)),d=a(2),l=a(0),o=a.n(l),c=a(26),u=a.n(c),p=a(424),m=(a(420),a(14));class b extends o.a.Component{constructor(){super(),this.onMinimizeClicked=this.onMinimizeClicked.bind(this),this.onMaximizeClicked=this.onMaximizeClicked.bind(this),this.state={size:-1}}onMinimizeClicked(){const e=this.getSize();this.animate(e,50,-50,(e,t)=>e<t,e=>new Promise(t=>{this.setState({size:e<50?50:e},()=>t())})),this.setState(Object(d.a)({},this.state))}onMaximizeClicked(){const e=this.getSize();this.animate(e,300,50,(e,t)=>e>t,e=>new Promise(t=>{this.setState({size:e},()=>t())}))}getSize(){const e=u.a.findDOMNode(this);switch(this.props.orientation){case"horizontal":return e.offsetHeight;case"vertical":return e.offsetWidth;default:return 0}}animate(e,t,a,i,n){const s=()=>{i(e,t)||n(e+=a).then(()=>{requestAnimationFrame(s)})};s()}render(){return Object(m.jsxs)(p.b,Object(d.a)(Object(d.a)({size:this.state.size},this.props),{},{children:[Object(m.jsx)(s.a,{style:{position:"fixed",zIndex:1,width:"100%"},children:Object(m.jsx)(n.a,{xs:24,sm:24,md:12,lg:9,xl:7,children:Object(m.jsxs)(s.a,{type:"flex",align:"middle",justify:"space-between",style:{height:50,width:"100%",fontSize:"1.2em",background:" #fafafa",borderBottom:"1px solid #d9d9d9",borderRight:"1px solid #d9d9d9",borderTop:"1px solid #d9d9d9",padding:"0px 10px"},children:[Object(m.jsx)(n.a,{flex:"auto",style:{overflow:"hidden"},children:Object(m.jsx)(s.a,{align:"middle",children:Object(m.jsx)(r.a.Title,{level:5,style:{margin:0},children:this.props.title})})}),Object(m.jsx)(n.a,{flex:"none",children:Object(m.jsxs)(s.a,{type:"flex",align:"middle",gutter:16,children:[Object(m.jsx)(n.a,{children:this.props.counter}),Object(m.jsxs)(n.a,{children:[Object(m.jsx)(i.a,{type:"text",shape:"circle",onClick:this.onMinimizeClicked,children:Object(m.jsx)(r.a.Title,{level:5,children:"-"})}),Object(m.jsx)(i.a,{type:"text",shape:"circle",onClick:this.onMaximizeClicked,children:Object(m.jsx)(r.a.Title,{level:5,children:"+"})})]})]})})]})})}),Object(m.jsx)("div",{style:{paddingTop:50},children:this.props.children})]}))}}t.a=b},382:function(e,t,a){"use strict";a.r(t),a.d(t,"codepush_environment_options",function(){return g}),a.d(t,"true_false",function(){return y});a(362);var i=a(363),n=(a(351),a(352)),s=(a(371),a(374)),r=(a(220),a(361)),d=(a(219),a(69)),l=(a(357),a(358)),o=(a(0),a(360)),c=a(380),u=(a(356),a(6)),p=a(68),m=a(14);const{Option:b}=l.a,h=[{id:"user",name:"Usuario"},{id:"admin",name:"Administrador"}],j=[{id:"active",name:"Activo"},{id:"disabled",name:"Desactivado"},{id:"pending validation",name:"Pendiente de validaci\xf3n"},{id:"pending_information",name:"Pendiente por informaci\xf3n"}],x=[{id:"male",name:"Masculino"},{id:"female",name:"Femenino"}],g=[{id:"production",name:"production"},{id:"staging",name:"staging"}],y=[{id:"false",name:"False"},{id:"true",name:"True"}];t.default=e=>{let{source:t}=e;const{id:a}=Object(u.s)(),f=Object(u.q)();return Object(m.jsx)(i.a.Content,{style:{height:"100%",overflow:"auto",padding:"2rem"},children:Object(m.jsx)(n.a,{style:{padding:"2rem",background:"white",borderRadius:"0.5rem"},children:Object(m.jsxs)(o.d,{id:a,source:t||"users",onSubmit:()=>{f("/dashboard/management/users")},textAcceptButton:a?"ACTUALIZAR":"CREAR",children:[a&&Object(m.jsx)(o.b,{flex:1,path:"users/".concat(a,"/avatar/"),name:"avatar_gallery",source:"avatar_gallery",onFinish:(e,t)=>((e,t,a,i)=>{const n=Object(p.b)("users"),s=Object(p.b)("gallery");let r={meta_file_name:a.name,meta_size:String(a.size),name:a.name,meta_media_type:a.type,path:t,description:""};s.create(r).then(t=>{let{id:a}=t;"create"!==i&&n.patch(i,{[e]:a}).then(e=>{}).catch(e=>d.b.error(e.message))}).catch(e=>d.b.error(e.message))})("avatar_gallery_id",e,t,a)}),Object(m.jsx)(r.a,{size:"large",flex:.5,placeholder:"Nombre",label:"Nombre",name:"first_name",validations:[{required:!0,message:"El nombre es requerido"}]}),Object(m.jsx)(r.a,{size:"large",flex:.5,placeholder:"Apellido",label:"Apellido",name:"last_name",validations:[{required:!0,message:"El apellido es requerido"}]}),Object(m.jsx)(r.a,{size:"large",flex:.5,placeholder:"Email",label:"Correo",type:"email",name:"email",validations:[{required:!0,message:"El email es requerido"}]}),Object(m.jsx)(r.a.Password,{size:"large",flex:.5,type:"password",placeholder:"\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf",label:"Contrase\xf1a",name:"password",validations:[!a&&{required:!0,message:"La contrase\xf1a es requerida"}]}),Object(m.jsx)(l.a,{size:"large",name:"gender",label:"Genero",placeholder:"Seleccionar",children:x.map(e=>Object(m.jsx)(b,{children:e.name},e.id))}),!a&&Object(m.jsx)(s.a,{xtype:"date",size:"large",label:"Fecha de nacimiento",name:"birthday",format:"MM/DD/YYYY",locale:c.a}),Object(m.jsx)(r.a,{xtype:"phone",input:!0,size:"large",flex:.1,placeholder:"Ej: 57",label:"C\xf3digo del Pa\xeds",name:"phone_country_code",validations:[{required:!0,message:"El c\xf3digo del pa\xeds es requerido"}]}),Object(m.jsx)(r.a,{xtype:"phone",input:!0,size:"large",flex:.2,placeholder:"Celular",label:"Celular",type:"tel",name:"phone",validations:[{required:!0,message:"El tel\xe9fono celular es requerido"}]}),"(",Object(m.jsx)(l.a,{size:"large",label:"Elige un rol para el usuario",name:"role",placeholder:"Elige un rol para el usuario",validations:[{required:!0,message:"El estado es requerido"}],children:h.map(e=>Object(m.jsx)(b,{children:e.name},e.id))}),Object(m.jsx)(l.a,{size:"large",name:"status",label:"Estado",placeholder:"Seleccionar",validations:[{required:!0,message:"El estado es requerido"}],children:j.map(e=>Object(m.jsx)(b,{children:e.name},e.id))}),Object(m.jsx)(l.a,{size:"large",name:"account_manager",label:"Account manager",placeholder:"Seleccionar",children:y.map(e=>Object(m.jsx)(b,{children:e.name},e.id))}),Object(m.jsx)(l.a,{size:"large",name:"test_user",label:"Test User",placeholder:"Seleccionar",children:y.map(e=>Object(m.jsx)(b,{children:e.name},e.id))}),Object(m.jsx)(l.a,{size:"large",name:"codepush_enviorment",label:"Code Push Environment",placeholder:"Seleccionar",children:g.map(e=>Object(m.jsx)(b,{children:e.name},e.id))}),Object(m.jsx)(r.a.TextArea,{flex:1,name:"disabled_reason",label:"Disabled Reason",size:"large",autoSize:!0})]})})})}},391:function(e,t,a){"use strict";a.d(t,"a",function(){return l.a});a(382),a(2),a(12),a(0),a(389);var i,n=a(390),s=a(61),r=a(53);Object(r.default)(n.a)(i||(i=Object(s.a)(["\n    ","\n"])),e=>{let{transparent:t}=e;if(t)return"\n                & .ant-modal-content, .ant-modal-header {\n                    background-color: transparent!important;\n                    box-shadow: none!important;\n                }\n                & .ant-modal-header {\n                    border-bottom: 0px!important;\n                }\n                & .ant-modal-body {\n                    height: 85vh!important;\n                    padding-top: 50px!important;\n                }\n                & .ant-modal-footer {\n                    display: flex;\n                    justify-content: center;\n                    align-items: center;\n                    color: #FFF!important;\n                    border-top: 0px!important;\n                }\n                & .ant-list-item-meta-title{\n                    color: rgb(255 255 255);\n                    text-align:left;\n                }\n                & .ant-btn-link, .ant-btn-link:hover, .ant-btn-link:focus{\n                    color: rgb(255 255 255)!important;\n                }\n                & .ant-list-item-meta-description {\n                    color: rgb(255 255 255 / 90%);\n                }\n                & .ant-modal-close-x {\n                    font-size: 24px;\n                    color: #bbb;\n                }\n            "});a(14);var d;r.default.div(d||(d=Object(s.a)(["\n    display: flex;\n    justify-content: start;\n    align-items: baseline;\n    flex-wrap: wrap;\n    /* background-color:var(--gray-dark-1)!important; */\n    color: var(--gray-dark-1)!important;\n    & .ant-checkbox-wrapper{\n        margin:0px 10px;\n    }\n    & h2{\n        color: var(--antd-wave-shadow-color);\n        padding: 4px 10px!important;\n        font-size: 18px!important;\n        font-weight: bold;\n        vertical-align: middle!important;\n        margin-bottom: 0px!important;\n    }\n"])));a(381);var l=a(364)},560:function(e,t,a){"use strict";t.a=a.p+"static/media/edit.38b6b889.svg"},561:function(e,t,a){"use strict";t.a=a.p+"static/media/delete.87358f25.svg"},660:function(e,t,a){"use strict";a.d(t,"a",function(){return r});a(219);var i=a(69),n=a(0),s=a(68);const r=e=>{let{establishment_id:t}=e;const[a,r]=Object(n.useState)([]),d=Object(s.b)("deals");return Object(n.useEffect)(()=>{t&&d.find({query:{establishment_id:t,$limit:1e4}}).then(e=>{let{data:t}=e;r(t||[])}).catch(e=>i.b.error(e.message))},[t]),[a]}},661:function(e,t,a){"use strict";a.d(t,"a",function(){return r});a(219);var i=a(69),n=a(0),s=a(68);const r=e=>{let{establishment_id:t}=e;const[a,r]=Object(n.useState)([]),d=Object(s.b)("third-party-codes-list");return Object(n.useEffect)(()=>{t&&d.find({query:{establishment_id:t,$limit:1e4}}).then(e=>{let{data:t}=e;r(t||[])}).catch(e=>{i.b.error(e.message),r()})},[t]),[a]}},679:function(e,t,a){"use strict";a(531);var i=a(36),n=(a(394),a(393)),s=(a(532),a(570)),r=(a(143),a(142)),d=(a(445),a(484)),l=(a(386),a(387)),o=(a(220),a(361)),c=(a(371),a(374)),u=a(2),p=(a(436),a(438)),m=(a(368),a(369)),b=(a(219),a(69)),h=a(12),j=(a(357),a(358)),x=a(0),g=a.n(x),y=a(144),f=a.n(y),O=a(68),v=a(353),_=a(561),w=a(560),C=a.p+"static/media/closeGray.6d5ecf2c.svg",S=a(359),k=a(54),z=a(14);const q=["input","record","onChange","onSearch","source","dataIndex","placeholder","reference","allowClear"],E=["editing","dataIndex","title","inputType","xtype","record","name","index","children"],T=["editing","dataIndex","title","inputType","xtype","record","index","children","required","dependencyField","dependencyCondition"],I="hh:mm a",{Option:D}=j.a,F=g.a.createContext(),A=e=>{let{input:t,record:a,onChange:i,onSearch:n,source:s,dataIndex:r,placeholder:d,reference:l,allowClear:o}=e,c=Object(h.a)(e,q);const[u,p]=Object(x.useState)(),[m,g]=Object(x.useState)(),[y,f]=Object(x.useState)(),[v,_]=Object(x.useState)(!1);return Object(x.useEffect)(()=>{if(c.choices){p(c.choices);let e=(c.choices||[]).filter(e=>e.id==a[r]),t=e.length>0?e[0].name:"";e=e.length>0?e[0].id:"",g(t),f(e)}else a[s||r]&&(g(a[s||r].name),f(a[s||r].id));l&&(async()=>{if(l){const e=Object(O.b)(l);_(!0),await e.find({}).then(e=>{var t;let{data:i}=e;_(!1),g(null===(t=i.find(e=>a[s||r]===e.id))||void 0===t?void 0:t[m||"name"]),p(i)}).catch(e=>{_(!1),b.b.error(e.message)})}})()},[a]),t?Object(z.jsx)(j.a,{loading:v,defaultValue:y||a[r],showSearch:!0,style:c.style||{width:200},placeholder:d||"Seleccione un registro",optionFilterProp:"children",onChange:e=>{i(r,e||null)},onSearch:n,filterOption:(e,t)=>t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0,allowClear:o,children:u&&u.map(e=>Object(z.jsx)(D,{value:e[e.optionValue||"id"],children:e[e.optionText||"name"]}))}):Object(z.jsx)(z.Fragment,{children:m})};class M extends g.a.Component{constructor(){super(...arguments),this.getInput=e=>{var t;let{defaultValue:a}=e;const{xtype:i,name:n,placeholder:s,onChange:r,onSearch:d,choices:l,source:b,record:h,dataIndex:j,formatter:x,parser:g}=this.props;switch(i){case"numberfield":return Object(z.jsx)(m.a,{min:0,formatter:x,parser:g});case"timefield":return Object(z.jsx)(p.a,{minuteStep:k.e,use12Hours:!0,placeholder:s,name:n,format:I});case"selectfield":return Object(z.jsx)(A,Object(u.a)({input:!0},this.props));case"datefield":return Object(z.jsx)(c.a,{showTime:!(null===(t=this.props)||void 0===t||!t.showTime),style:{width:150}});default:return Object(z.jsx)(o.a,{})}},this.renderField=()=>{const e=this.props,{editing:t,dataIndex:a,title:i,inputType:n,xtype:s,record:r,name:d,index:l,children:o}=e;Object(h.a)(e,E);switch(s){case"selectfield":return Object(z.jsx)(A,Object(u.a)({},this.props));case"timefield":return"".concat(f()(f()(r[a],I)).format("hh:mm a"));default:return o}},this.renderCell=e=>{const t=this.props,{editing:a,dataIndex:i,title:n,inputType:s,xtype:r,record:d,index:o,children:c,required:p,dependencyField:m,dependencyCondition:b}=t,j=Object(h.a)(t,T);return Object(z.jsx)("td",Object(u.a)(Object(u.a)({},j),{},{children:a?Object(z.jsx)(l.a.Item,{noStyle:!0,shouldUpdate:(e,t)=>e[i]!==t[i]||m&&e[m]!==t[m],children:e=>{let{getFieldValue:t}=e;return m&&b&&t(m)===b||!m&&!b?Object(z.jsx)(l.a.Item,{style:{margin:0},name:i,rules:[{required:p||!1,message:"Please Input ".concat(n,"!")}],children:this.getInput({record:d,defaultValue:"timefield"===r?f()(f()(d[i],I)):"datefield"===r?f()(d[i]):d[i]})}):null}}):this.renderField(this.props)}))}}render(){return Object(z.jsx)(F.Consumer,{children:this.renderCell})}}class R extends g.a.Component{constructor(e){super(e),this.handleChange=(e,t)=>{console.log(e,t),this.props.onChange&&this.props.onChange(e,t,this.props.form),this.props.form.setFieldsValue({[e]:t})},this.isEditing=e=>e.key===this.state.editingKey,this.cancel=()=>{this.setState({editingKey:""})},this.save=async(e,t)=>{await e.validateFields().then(async()=>{this.props.onSubmit&&await Promise.resolve(this.props.onSubmit(Object(u.a)({id:t.id},e.getFieldsValue()),t)).then(()=>{this.cancel(t.key)})}).catch(()=>console.log("No valido"))},this.delete=async e=>{this.props.onDelete&&await this.props.onDelete(e)},this.renderEmpty=()=>{if(this.props.renderEmpty)return this.props.renderEmpty();let{source:e}=this.props;return Object(z.jsx)(z.Fragment,{children:Object(z.jsx)(d.a,{image:d.a.PRESENTED_IMAGE_DEFAULT,imageStyle:{height:60},description:Object(z.jsx)("span",{children:this.props.newTextDescription?this.props.newTextDescription:"A\xfan no hay registros, empieza agregando uno nuevo"}),children:this.props.onNew&&Object(z.jsx)(r.a,{onClick:()=>this.props.onNew(),size:"large",type:"primary",children:this.props.newText||Object(z.jsxs)("span",{children:[" ",Object(z.jsx)(v.u,{})," "," ","AGREGAR"]})})})})},this.state={data:[],editingKey:"",actions:e.actions||{edit:e.isAdmin,delete:e.isAdmin}},this.columns=[...this.props.columns],(this.state.actions.edit||this.state.actions.delete)&&(this.columns=[...this.columns,{title:"Acciones",dataIndex:"operation",render:(e,t)=>{const{editingKey:a}=this.state;return this.isEditing(t)?Object(z.jsxs)("span",{children:[Object(z.jsx)(F.Consumer,{children:e=>Object(z.jsx)(S.a,{type:"primary",onClick:()=>this.save(e,t),style:{marginRight:8,borderRadius:"0.5rem"},icon:Object(z.jsx)(v.y,{})})}),Object(z.jsx)(F.Consumer,{children:e=>Object(z.jsx)(s.a,{title:"Desea Cancelar?",onConfirm:()=>{this.cancel(t.key)},children:Object(z.jsx)(r.a,{type:"text",icon:Object(z.jsx)("img",{src:C,alt:"Cerrar"})})})})]}):Object(z.jsxs)(z.Fragment,{children:[this.state.actions.edit&&Object(z.jsx)(F.Consumer,{children:e=>Object(z.jsx)(r.a,{icon:Object(z.jsx)("img",{src:w.a,alt:"Editar"}),type:"text",disabled:""!==a,onClick:()=>{this.edit(t.key),e.setFieldsValue(Object(u.a)(Object(u.a)({},t),{},{start_hour:f()(f()(null===t||void 0===t?void 0:t.start_hour,I)),end_hour:f()(f()(null===t||void 0===t?void 0:t.end_hour,I)),inactive_until:null!==t&&void 0!==t&&t.inactive_until?f()(null===t||void 0===t?void 0:t.inactive_until):null}))}})}),this.state.actions.delete&&Object(z.jsx)(S.a,{type:"text",icon:Object(z.jsx)("img",{src:_.a,alt:"Eliminar"}),onClick:()=>this.delete({id:t.key})})]})}}])}edit(e){this.setState({editingKey:e})}componentWillReceiveProps(e){let{dataSource:t}=e;t!==this.state.data&&this.setState({data:t})}componentDidMount(){let{dataSource:e}=this.props;this.setState({data:e})}render(){const e={body:{cell:M}},t=this.columns.map(e=>e.editable?Object(u.a)(Object(u.a)({},e),{},{onCell:t=>Object(u.a)({record:t,inputType:"age"===e.dataIndex?"number":"text",xtype:e.xtype,choices:e.choices,dataIndex:e.dataIndex,title:e.title,editing:this.isEditing(t),onChange:this.handleChange},e)}):e);return Object(z.jsx)(i.a,{renderEmpty:this.renderEmpty,children:Object(z.jsx)(F.Provider,{value:this.props.form,children:Object(z.jsx)(n.a,{size:"small",bordered:!1,loading:this.props.loading,rowKey:this.props.rowKey||"id",components:e,dataSource:this.state.data&&this.state.data.map(e=>Object(u.a)({key:e.id},e)),columns:t,showHeader:!0,scroll:this.props.scroll,onExpand:this.props.onExpand,expandedRowRender:this.props.expandedRowRender,pagination:!1})})})}}t.a=e=>{const[t]=l.a.useForm();return Object(z.jsx)(l.a,{form:t,children:Object(z.jsx)(R,Object(u.a)(Object(u.a)({},e),{},{form:t}))})}}}]);
//# sourceMappingURL=29.c2878a46.chunk.js.map