(this["webpackJsonppartners-apparta"]=this["webpackJsonppartners-apparta"]||[]).push([[69],{1122:function(e,t,a){"use strict";a.r(t);a(362);var i=a(363),n=(a(366),a(367)),s=(a(503),a(516)),l=(a(427),a(432)),r=(a(368),a(369)),c=(a(219),a(361)),o=(a(375),a(376)),d=(a(422),a(426)),A=(a(218),a(69)),g=(a(386),a(387)),b=a(2),u=(a(357),a(358)),h=a(12),m=(a(143),a(142)),E=(a(372),a(373)),j=(a(408),a(412)),Q=a(6),p=a(0),O=a(353),k=a(359),B=a(356),v=a(360),C=a(398),x=a(370),I=a(68),S=a(42),y=a.n(S);const _=e=>{let{establishment_id:t}=e;const a=Object(I.b)("establishments-menu-items-categories"),[i,n]=Object(p.useState)([]),[s,l]=Object(p.useState)(!1);return Object(p.useEffect)(()=>{t?(l(!0),a.find({query:{establishment_id:t,status:"active",$limit:1e4,$select:["id","name","status"]}}).then(e=>{let{data:t}=e;n(t),l(!1)}).catch(e=>{A.b.error(e),l(!1)})):n([])},[t]),[i,s]},J=e=>{let{establishment_id:t}=e;const a=Object(I.b)("establishment-menu-items"),[i,n]=Object(p.useState)([]),[s,l]=Object(p.useState)(!1);return Object(p.useEffect)(()=>{t?(l(!0),a.find({query:{establishment_id:t,apparta_menu_status:"active",$limit:1e4}}).then(e=>{let{data:t}=e;n(t),l(!1)}).catch(e=>{A.b.error(e),l(!1)})):n([])},[t]),[i,s]};var N=a(54),f=a(14);const w=["choices","valueField"],K=["id"],F=[{id:"active",name:"Activo"},{id:"inactive",name:"Inactivo"}],z=[{id:"menu",address:"Ir a menu"},{id:"index",address:"Ir a index"}],R={menu:e=>{let{slug:t,establishment_branch_id:a,category:i,menu_item_id:n}=e;return n?"/".concat(t,"/").concat(a,"/menu/?pId=").concat(n):i?"/".concat(t,"/").concat(a,"/menu/?scrollTop=").concat(y.a.replace(y.a.trim(y.a.toLower(i)),/ /g,"-")):a?"/".concat(t,"/").concat(a,"/menu/"):"/".concat(t,"/")},index:e=>{let{slug:t,establishment_branch_id:a}=e;return"/".concat(t,"/").concat(a?a+"/":"")}},U=e=>{let{onRemove:t,onEdit:a,onWatch:i}=e;return[{title:"Id",dataIndex:"id",key:"id",sorter:!0},{dataIndex:"path_image",key:"path_image",title:"Foto",render:e=>e&&Object(f.jsx)(j.a,{size:"large",alt:"Banner",height:35,width:90,src:"".concat(N.f,"/").concat(window.imageShark({url:e,width:90,height:35})),preview:{src:"".concat(N.j).concat(e)},fallback:"data:image/png;base64,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"})},{title:"Nombre",dataIndex:"name",key:"name",sorter:!0},{title:"Link",dataIndex:"link",key:"link"},{title:"Prioridad",dataIndex:"priority",key:"priority",sorter:!0},{title:"Estado",dataIndex:"status",key:"status",sorter:!0,render:e=>Object(f.jsxs)(E.a,{color:"active"===e?"success":"error",children:[" ",e]})},{title:"Acciones",dataIndex:"id",render:(e,i)=>Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(m.a,{type:"text",onClick:()=>a(i),icon:Object(f.jsx)(O.l,{})}),Object(f.jsx)(k.a,{type:"link",onClick:()=>t({id:e}),icon:Object(f.jsx)(O.h,{}),confirmText:"Desea eliminar?"})]})}]},L=e=>{let{choices:t,valueField:a}=e,i=Object(h.a)(e,w);return Object(f.jsx)(u.a,Object(b.a)(Object(b.a)({},i),{},{showSearch:!0,optionFilterProp:"children",filterOption:(e,t)=>t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0,children:y.a.map(t,(e,t)=>Object(f.jsx)(u.a.Option,{value:a?e[a]:e.id,children:e.address||e.name},t))}))};t.default=e=>{let{location:t}=e;const a=Object(Q.q)(),[m]=g.a.useForm(),E=g.a.useWatch("id",m),{menu_link_tree_group_id:j,menu_link_tree_group_name:k}=t.state,N=Object(I.b)("menu-linktree-groups-links"),[w,Y]=Object(p.useState)(!1),[q,T]=Object(p.useState)(!1),[P,M]=Object(p.useState)(),[H,D]=Object(p.useState)(!1),[G,Z]=Object(p.useState)({}),X=e=>{null!==e&&void 0!==e&&e.establishment_id?Z(Object(b.a)({link_type:null===G||void 0===G?void 0:G.link_type},e)):Z(Object(b.a)(Object(b.a)({},G),e))},[V,W,$]=(()=>{const e=Object(I.b)("establishments"),[t,a]=Object(p.useState)([]),[i,n]=Object(p.useState)(!1);return[t,i,Object(S.debounce)(t=>{""!==t?(n(!0),e.find({query:{q:t,$client:{skipJoins:!0},$limit:50,$select:["id","name","slug"]}}).then(e=>{let{data:t}=e;a(y.a.map(t,e=>{let{id:t,name:a,slug:i}=e;return{id:JSON.stringify({id:t,slug:i}),name:a}})),n(!1)}).catch(e=>{A.b.error(e),n(!1)})):a([])},500,{maxWait:800})]})(),[ee,te]=(e=>{let{establishment_id:t}=e;const a=Object(I.b)("establishments-branchs"),[i,n]=Object(p.useState)([]),[s,l]=Object(p.useState)(!1);return Object(p.useEffect)(()=>{t?(l(!0),a.find({query:{establishment_id:t,apparta_menu_status:"active",$limit:1e3,$sort:{address:1},$select:["address","id"]}}).then(e=>{let{data:t}=e;n(t),l(!1)}).catch(e=>{A.b.error(e.message),l(!1)})):n([])},[t]),[i,s]})({establishment_id:G.establishment_id}),[ae,ie]=_({establishment_id:G.establishment_id}),[ne,se]=J({establishment_id:G.establishment_id});return Object(p.useEffect)(()=>{if(y.a.some(G)&&null!==G&&void 0!==G&&G.slug&&null!==G&&void 0!==G&&G.link_type){const e=R[G.link_type](Object(b.a)(Object(b.a)({},G),{},{slug:G.slug}));m.setFieldsValue({link:e}),D(!0)}else m.setFieldsValue({link:void 0}),D(!1)},[G,m]),Object(f.jsxs)(i.a.Content,{style:{height:"100%",overflow:"auto",padding:"2rem"},children:[Object(f.jsxs)(d.a,{children:[Object(f.jsx)(d.a.Item,{onClick:()=>a("/dashboard/management/menu-banners",{state:{defaultSelectedTab:"3"}}),style:{cursor:"pointer"},children:"Perfil de grupos"}),Object(f.jsx)(d.a.Item,{children:k||""})]}),Object(f.jsx)(o.a,{style:{background:"transparent",borderTop:0,marginTop:0}}),Object(f.jsx)(B.b,{custom:!0,source:"menu-linktree-groups-links",filterDefaultValues:{menu_link_tree_group_id:j,$sort:{id:-1}},searchField:"name",searchText:"Grupo...",search:!0,permitFetch:!0,actions:{},updateSource:w,columns:U({onRemove:async e=>{let{id:t}=e;await N.remove(t).then(()=>{A.b.success("Link eliminado!"),Y(!w)}).catch(e=>A.b.error("No se pudo eliminar el Grupo! "+(null===e||void 0===e?void 0:e.message)))},onEdit:e=>{M(Object(b.a)({},y.a.mapValues(e,e=>{if(null!==e)return e}))),T(!0)}}),extra:Object(f.jsx)("div",{children:Object(f.jsx)(x.a,{type:"primary",icon:Object(f.jsx)(O.u,{}),onClick:()=>{T(!0),M(void 0),m.resetFields()},children:"Agregar"})})}),q&&Object(f.jsx)(n.a,{width:520,title:"".concat(P?"Editar":"Crear"," Link"),placement:"right",visible:q,onClose:()=>{T(!1),M(),m.resetFields(),Z({})},children:Object(f.jsxs)(v.d,{form:m,textAcceptButton:"Guardar",onSubmit:async(e,t)=>{if(e)return A.b.error(e);delete t.path_image,delete t.link_generator;const{id:a}=t,i=Object(h.a)(t,K);E?await N.patch(E,Object(b.a)({},i)).then(()=>{A.b.success("Link actualizada!"),T(!1),M(),m.resetFields(),Z({}),Y(!w)}).catch(e=>A.b.error(e.message)):await N.create(Object(b.a)({},i)).then(()=>{A.b.success("Link creada!"),T(!1),M(),m.resetFields(),Y(!w)}).catch(e=>A.b.error(e.message))},initialValues:P,children:[Object(f.jsx)(c.a,{type:"hidden",name:"id"}),!E&&Object(f.jsx)(c.a,{type:"hidden",name:"menu_link_tree_group_id",initial:j}),E&&(null===P||void 0===P?void 0:P.path_image)&&Object(f.jsx)(C.a,{refresh:(e,t)=>{M(Object(b.a)({},t)),m.setFieldsValue(Object(b.a)({},y.a.mapValues(t,e=>{if(null!==e)return e}))),Y(!w)},size:"large",record:P,defaultImage:null===P||void 0===P?void 0:P.path_image,source:"path_image",withCropper:!0,setterVisibleCropper:()=>{},reference:"menu-linktree-groups-links",_id:E,path:"group_link_path_image/".concat(E)}),E&&Object(f.jsx)(v.b,{flex:1,preview:!1,title:"Imagen",path:"group_link_path_image/".concat(E,"/"),name:"path_image",source:"path_image",style:{borderRadius:"0.5rem"},onFinish:(e,t)=>((e,t,a,i)=>{N.patch(i,{[e]:String(t)}).then(e=>{M(Object(b.a)({},e)),m.setFieldsValue(Object(b.a)({},y.a.mapValues(e,e=>{if(null!==e)return e}))),Y(!w)}).catch(e=>A.b.error(e.message))})("path_image",e,0,E)}),Object(f.jsx)(c.a,{flex:1,name:"name",label:"Nombre",size:"large",validations:[{required:!0,message:"Nombre es requerido"}]}),Object(f.jsx)(r.a,{flex:1,name:"priority",label:"Prioridad",size:"large"}),Object(f.jsx)(u.a,{flex:1,name:"status",label:"Estado",size:"large",validations:[{required:!0,message:"Estado es requerido"}],children:y.a.map(F,(e,t)=>{let{id:a,name:i}=e;return Object(f.jsx)(u.a.Option,{value:a,children:i},t)})}),Object(f.jsx)(c.a.TextArea,{flex:1,size:"large",name:"link",label:"Link",autoSize:!0,disabled:H,validations:[{required:!0,message:"Link es requerido"}]}),Object(f.jsx)("div",{flex:1,name:"link_generator",children:Object(f.jsx)(s.a,{ghost:!0,children:Object(f.jsx)(s.a.Panel,{header:"Generar link",children:Object(f.jsxs)(l.b,{direction:"vertical",style:{width:"100%"},size:"middle",children:[Object(f.jsx)(L,{placeholder:"Tipo de link",label:"Tipo de link",name:"link_type",size:"large",allowClear:!0,choices:z,onChange:e=>X({link_type:e})}),Object(f.jsx)(L,{placeholder:"Establecimiento",name:"establishment_id",label:"Establecimiento",size:"large",allowClear:!0,onSearch:$,loading:W,choices:V,onChange:e=>{if(e){const{id:t,slug:a}=JSON.parse(e);X({establishment_id:t,slug:a})}else X({establishment_id:void 0,slug:void 0})}}),(null===G||void 0===G?void 0:G.establishment_id)&&Object(f.jsx)(L,{placeholder:"Sucursal",name:"establishment_branch_id",label:"Sucursal",size:"large",allowClear:!0,loading:te,choices:ee,onChange:e=>X({establishment_branch_id:e})}),(null===G||void 0===G?void 0:G.link_type)===z[0].id&&(null===G||void 0===G?void 0:G.establishment_id)&&Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(L,{placeholder:"Menu Categoria",name:"category",label:"Sucursal",size:"large",allowClear:!0,choices:ae,loading:ie,value:null===G||void 0===G?void 0:G.category,onChange:e=>X({category:e,menu_item_id:void 0}),valueField:"name"}),Object(f.jsx)(L,{placeholder:"Menu Item",name:"menu_item_id",label:"Sucursal",size:"large",allowClear:!0,loading:se,choices:ne,value:null===G||void 0===G?void 0:G.menu_item_id,onChange:e=>X({menu_item_id:e,category:void 0})})]})]})},"1")})})]})})]})}}}]);
//# sourceMappingURL=69.c23886d3.chunk.js.map